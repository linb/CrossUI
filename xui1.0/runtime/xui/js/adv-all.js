Class("xui.UI.FusionChartFree","xui.UI.Flash",{Instance:{refreshChart:function(){this.refreshFlash()},setDataXML:function(a){var d=this.get(0),c=d.box._getSWF(d);if(c){c.SetVariable("_root.dataURL","");c.SetVariable("_root.isNewData","1");c.SetVariable("_root.newData",a);c.TGotoLabel("/","JavaScriptHandler")}}},Static:{_FC_LINKTAG:"JavaScript:",_FC_SWFFILEPRETAG:"FCF_",DataModel:{selectable:true,FC_eventHandler:{ini:true,action:function(){this.boxing().refreshChart()}},FC_chartType:{combobox:"Column2D,Column3D,Pie2D,Pie3D,Line,Bar2D,Area2D,Doughnut2D,MSColumn2D,MSColumn3D,MSLine,MSArea2D,MSBar2D,StackedColumn2D,StackedColumn3D,StackedArea2D,StackedBar2D,Candlestick,Funnel,Gantt".split(","),ini:"Column2D",action:function(a){var c=this,d=c.properties;if(d.FC_demoDataPath){xui.Ajax(d.FC_demoDataPath+a+".xml",{rnd:_()},function(e){d.FC_data=xui.XML.xml2json(e,null,function(f){return c.box.replaceSpecialChars(x)})},null,null,{asy:false,rspType:"xml"}).start()}d.src=d.FC_swfPath+this.box._FC_SWFFILEPRETAG+d.FC_chartType+".swf",this.boxing().refreshChart()}},FC_swfPath:"FusionChartsFree/Charts/",FC_demoDataPath:"FusionChartsFree/Data/",FC_attrs:{ini:{bgcolor:"transparent",quality:"high",allowScriptAccess:"always",debugMode:"false",registerWithJS:"1",scaleMode:"noScale"},action:function(){this.boxing().refreshChart()}},FC_labels:{ini:{PBarLoadingText:"Loading Chart. Please Wait",XMLLoadingText:"Retrieving Data. Please Wait",ParsingDataText:"Reading Data. Please Wait",ChartNoDataText:"No data to display",RenderingChartText:"Rendering Chart. Please Wait",LoadDataErrorText:"Error in loading data",InvalidXMLText:"Invalid XML data"},action:function(){this.boxing().refreshChart()}},FC_data:{ini:{},action:function(a){var c=this;c.box._buildChartXML(c,function(d){c.boxing().setDataXML(c.box._encodeDataXML(xui.XML.json2xml(d)))})}}},RenderTrigger:function(){this.boxing().setFC_chartType(this.properties.FC_chartType,true).refreshChart()},EventHandlers:{onFC_Click:function(c,a){},onFC_PrepareXML:function(c,a,d){},onFC_SetXML:function(c,a){}},replaceSpecialChars:function(a){return(""+a).replace(/\%/g,"%25").replace(/\&/g,"%26").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\'/g,"&apos;")},_encodeDataXML:function(e){var h=["\\$","\\+"];var d=e.match(/=\s*\".*?\"/g);if(d){for(var f=0;f<d.length;f++){var j=d[f].replace(/^=\s*\"|\"$/g,"");j=j.replace(/\'/g,"%26apos;");var g=e.indexOf(d[f]);var a="='"+j+"'";var c=e.substring(0,g);var k=e.substring(g+d[f].length);var e=c+a+k}}e=e.replace(/\"/g,"%26quot;");e=e.replace(/%(?![\da-f]{2}|[\da-f]{4})/ig,"%25");e=e.replace(/\&/g,"%26");return e},_buildChartXML:function(c,j){var i=this,a=c.properties,h=i.getFlashVersion();if(h.split(",")[0]<8){xui.alert(xui.getRes("inline.noFlash"));return""}var f=_.clone(a.FC_data);if(a.FC_eventHandler){var e=c.serialId,g=i._FC_LINKTAG,d;if(c.onFC_PrepareXML&&false===c.boxing().onFC_PrepareXML(c,f,j)){}else{if(d=(f.chart||f.graph)){if(d.set){_.arr.each(d.set,function(k){if(k){k["@link"]=encodeURIComponent(g+i.KEY+'._e("'+e+'","'+(k["@label"]||k["@name"]||"")+'","'+(k["@value"]||"")+'")')}})}_.arr.each(["lineSet","dataset","dataSet"],function(l){if(d[l]){var k=[];if(d.categories&&d.categories.category){_.arr.each(d.categories.category,function(n){k.push(n["@label"]||n["@name"]||"")})}var m=d[l];if(!_.isArr(m)){m=[m]}_.arr.each(m,function(n,o){if(n){_.arr.each(["lineSet","dataset","dataSet"],function(q){_.arr.each(n[q],function(r){if(r&&r.set){var s=r["@seriesName"]||r["@seriesname"]||"";_.arr.each(r.set,function(u,t){if(u){u["@link"]=encodeURIComponent(g+i.KEY+'._e("'+e+'","'+(k[t]||"")+'","'+s+'","'+(u["@value"]||u["@label"]||u["@name"]||"")+'")')}})}})});if(n.set){var p=n["@seriesName"]||n["@seriesname"]||"";_.arr.each(n.set,function(r,q){if(r){r["@link"]=encodeURIComponent(g+i.KEY+'._e("'+e+'","'+(k[q]||"")+'","'+p+'","'+(r["@value"]||r["@label"]||r["@name"]||"")+'")')}})}}})}});j(f)}else{j("")}}}else{j(f)}},_drawSWF:function(c){var a=this;a._buildChartXML(c,function(h){var j=c.properties,f=c.serialId,i=j.src,g={},e={},d="";if(j.flashvars&&!_.isEmpty(j.flashvars)){_.merge(g,j.flashvars,"all")}if(j.parameters&&!_.isEmpty(j.parameters)){_.merge(g,j.parameters,"all")}if(j.FC_attrs&&!_.isEmpty(j.FC_attrs)){_.merge(e,j.FC_attrs,"all")}if(j.flashvars&&!_.isEmpty(j.flashvars)){_.merge(e,j.flashvars,"all")}e.DOMId=c.box._idtag+c.serialId;e.chartWidth=j.width;e.chartHeight=j.height;e.dataXML=a._encodeDataXML(xui.XML.json2xml(h));if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){d+='<embed type="application/x-shockwave-flash" src="'+i+"?"+_.urlEncode(g)+'" ';d+='width="'+j.width+'" height="'+j.height+'" ';d+='id="'+e.DOMId+'" name="'+e.DOMId+'" ';d+='wmode="opaque" ';d+='flashvars="'+_.urlEncode(e)+'" ';d+="/>"}else{d+='<object id="'+e.DOMId+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ';d+='width="'+j.width+'" height="'+j.height+'">';d+='<param name="movie" value="'+i+"?"+_.urlEncode(g)+'" />';d+='<param name="wmode" value="opaque" />';d+='<param name="flashvars" value="'+_.urlEncode(e)+'" />';d+="</object>"}c.getSubNode("BOX").html(d,false);if(c.onFC_SetXML){c.boxing().onFC_SetXML(c,d)}})},_idtag:"xui_UI_FCF_",__events:{},_e:function(){var a=this.getFromDom(this.KEY+":"+arguments[0]+":"),d=a&&a.get(0);if(d&&!d.properties.disable&&d.onFC_Click){var c=_.toArr(arguments);c=c.slice(1);a.onFC_Click(d,c)}}}});Class("xui.UI.FusionChart3","xui.UI.FusionChartFree",{Instance:{setDataXML:function(a){var c=this.constructor._getSWF(this.get(0));if(c){return c.setDataXML(a)}},print:function(){var a=this.constructor._getSWF(this.get(0));if(a){return a.print()}},setDataURL:function(a){var c=this.constructor._getSWF(this.get(0));if(c){return c.setDataURL(a)}},getDataAsCSV:function(){var a=this.constructor._getSWF(this.get(0));if(a){return a.getDataAsCSV()}},hasRendered:function(){var a=this.constructor._getSWF(this.get(0));if(a){return a.hasRendered()}},getChartAttribute:function(a){var c=this.constructor._getSWF(this.get(0));if(c){return c.getChartAttribute(a)}},getXML:function(){var a=this.constructor._getSWF(this.get(0));if(a){return a.getXML()}},callFCFunction:function(d,c){var a=this.constructor._getSWF(this.get(0));if(a){return a[d].apply(a,c)}}},Initialize:function(){var d=this,c=function(h,f){if(h&&d._getSWF(h)){var e=d.getFromDom(d.KEY+":"+h.replace(d._idtag,"")+":"),g=e&&e.get(0);if(g&&g[f]){e[f](g)}}},a;a=window.FC_Loaded;window.FC_Loaded=function(e){c(e,"onFC_Loaded");if(a){a(e)}};a=window.FC_Rendered;window.FC_Rendered=function(e){c(e,"onFC_Rendered");if(a){a(e)}};a=window.FC_DataLoaded;window.FC_DataLoaded=function(e){c(e,"onFC_DataLoaded");if(a){a(e)}};a=window.FC_DataLoadError;window.FC_DataLoadError=function(e){c(e,"onFC_DataLoadError");if(a){a(e)}};a=window.FC_NoDataToDisplay;window.FC_NoDataToDisplay=function(e){c(e,"onFC_NoDataToDisplay");if(a){a(e)}};a=window.FC_DataXMLInvalid;window.FC_DataXMLInvalid=function(e){c(e,"onFC_DataXMLInvalid");if(a){a(e)}}},Static:{_idtag:"xui_UI_FC3_",_FC_SWFFILEPRETAG:"",DataModel:{selectable:true,FC_chartType:{combobox:"Column2D,Column3D,Pie2D,Pie3D,Line,Bar2D,Area2D,Doughnut2D,Doughnut3D,MSColumn2D,MSColumn3D,MSLine,MSArea,MSBar2D,MSBar3D,StackedColumn2D,StackedColumn3D,StackedArea2D,StackedBar2D,StackedBar3D,MSStackedColumn2D,MSCombi2D,MSCombi3D,MSColumnLine3D,MSCombiDY2D,MSColumn3DLineDY,StackedColumn3DLineDY,MSStackedColumn2DLineDY,Scatter,Bubble,ScrollColumn2D,ScrollLine2D,ScrollArea2D,ScrollStackedColumn2D,ScrollCombi2D,ScrollCombiDY2D".split(",")},FC_swfPath:"FusionCharts3/Charts/",FC_demoDataPath:"FusionCharts3/Data/"},EventHandlers:{onFC_Loaded:function(a){},onFC_Rendered:function(a){},onFC_DataLoaded:function(a){},onFC_DataLoadError:function(a){},onFC_NoDataToDisplay:function(a){},onFC_DataXMLInvalid:function(a){}}}});Class("xui.UI.TextEditor",["xui.UI.Widget","xui.absValue"],{Instance:{activate:function(){var a=this.get(0);a.getSubNode("INPUT").focus();return this},_setCtrlValue:function(a){if(_.isNull(a)||!_.isDefined(a)){a=""}return this.each(function(d){var e=d.getSubNode("INPUT").get(0);if(e.value.replace(/(\r\n|\r)/g,"\n")!=a.replace(/(\r\n|\r)/g,"\n")){var c=e.scrollTop;e.value=a;e.scrollTop=c}})},_getCtrlValue:function(c){var a=this.get(0);return a.getSubNode("INPUT").attr("value").replace(/(\r\n|\r)/g,"\n").replace(/( +)(\n)/g,"$2").replace(/\t/g,"    ")}},Initialize:function(){var a=this.getTemplate();_.merge(a.FRAME.BORDER,{BOX:{tagName:"div",INPUT:{tagName:"textarea",tabindex:"{tabindex}",style:"{_css}"}},BAK1:{},BAK2:{tagName:"div"}},"all");this.setTemplate(a)},Static:{Appearances:{BOX:{width:"100%",height:"100%",left:0,top:0,position:"absolute",overflow:(xui.browser.gek&&parseInt(xui.browser.ver,10)<3)?"auto":"hidden","z-index":"10"},INPUT:{"font-family":"Courier New, Courier, monospace","font-size":"12px","line-height":"14px",position:"absolute","background-color":"#fff",left:0,top:0,border:0,margin:0,padding:0,overflow:"auto","overflow-y":"auto","overflow-x":"hidden",resize:"none"},"BAK1, BAK2":{"font-family":"Courier New, Courier, monospace","font-size":"12px",position:"absolute",visibility:"hidden",left:"-10000px",top:"-10000px"}},Behaviors:{INPUT:{onFocus:function(a,c,d){a.box._onchange(a,xui.use(d).get(0))},onChange:function(a,c,d){a.boxing().setUIValue(xui.use(d).get(0).value);a.box._onchange(a,xui.use(d).get(0))},afterKeydown:function(g,j,c){var m=g.properties,l,o;if(m.disabled||m.readonly){return}if(g.$change){delete g.$change}var n=xui.Event.getKey(j),f=xui.use(c).get(0),h=n.key;switch(h){case"tab":var a=xui.use(c).caret(),d=f.value.slice(a[0],a[1]);if(/(\n|\r)/.test(d)){l=f.value.slice(0,a[0]);if(d.charAt(0)!="\n"&&d.charAt(0)!="\r"){d=l.slice(a[0]=l.lastIndexOf("\n"))+d}if(xui.browser.ie){o=(o=l.match(/\r/g))?o.length:0;a[0]-=o;o=(o=(f.value.slice(0,a[1])).match(/\r/g))?o.length:0;a[1]-=o}xui.use(c).caret(a[0],a[1]);if(n.shiftKey){d=d.replace(/(\n|\n\r)    /g,"$1")}else{d=d.replace(/(\n|\n\r)/g,"$1    ")}g.box.insertAtCaret(g,d);a[1]=a[0]+d.length;if(xui.browser.ie){o=(o=d.match(/\r/g))?o.length:0;a[1]-=o}xui.use(c).caret(a[0],a[1])}else{if(n.shiftKey){xui.use(c).caret(a[0]-4,a[0]-4);a[0]-=4;a[1]-=4}else{g.box.insertAtCaret(g,"    ");a[0]+=4;a[1]+=4}}g.$pos=a;return false;case"enter":var p=g.box.getParas(g);l=p[1];var i=l.length-_.str.ltrim(l).length;if(l.charAt(l.length-1)=="{"){i+=4}if(i){g.box.insertAtCaret(g,"\n"+_.str.repeat(" ",i));g.$enter=true;return false}break;default:if(g.tips){g.tips.destroy();g.tips=null}}f=null},afterKeypress:function(d,h,a){if(d.properties.disabled||d.properties.readonly){return}var n=xui.Event.getKey(h),f=n.key;var j=arguments.callee,c=j.map||(j.map={space:1,enter:1,backspace:1,tab:1,"delete":1});if(f.length==1||c[f]){d.$change=true}switch(f){case"tab":if(xui.browser.opr){_.asyRun(function(){xui.use(a).caret(d.$pos[0],d.$pos[1])})}return false;case"enter":if(d.$enter){delete d.$enter;return false}case"}":if(n.shiftKey){var p=d.box.getParas(d);var g=p[0],i=p[1],l=p[2],m=p[3];if(/ {4}$/.test(i)){var o=xui(a).scrollTop();m.value=m.value.substr(0,g).replace(/ {4}$/,"}")+m.value.substr(g,m.value.length);xui(m).onChange();d.box.setCaretTo(m,g-4+1,o);return false}}break}},afterKeyup:function(d,h,i){var c=xui.Event.getKey(h),a=c.key;var f=arguments.callee,g=f.map||(f.map={space:1,enter:1,backspace:1,tab:1,"delete":1});if(a.length==1||g[a]){d.$change=true}if(d.$change){delete d.$change;d.box._onchange(d,xui.use(i).get(0))}}}},DataModel:{selectable:true,left:0,top:0,width:200,height:200,position:"absolute",disabled:{ini:false,action:function(a){b.boxing().setReadonly(a)}},readonly:{ini:false,action:function(a){this.getSubNode("INPUT").attr("readonly",a).css("background",a?"#EBEADB":"")}}},EventHandlers:{onChange:function(d,c,a){}},RenderTrigger:function(){var a=this;if(a.properties.readonly){a.boxing().setReadonly(true,true)}var e=xui.browser.ie,d=a.getSubNode("INPUT").get(0),c=function(g){if(e&&g.propertyName!="value"){return true}var f=e?g.srcElement:this;a.box._onchange(a,f)};if(e){d.attachEvent("onpropertychange",c);d.attachEvent("ondrop",c);a.$ondestory=function(){d.detachEvent("onpropertychange",c);d.detachEvent("ondrop",c)}}else{d.addEventListener("input",c,false);d.addEventListener("dragdrop",c,false);a.$ondestory=function(){var f=this,g=f.getSubNode("INPUT").get(0);if(g){g.removeEventListener("input",c,false);g.addEventListener("dragdrop",c,false);g=null}};a.getSubNode("BOX").$firfox2()}},_onchange:function(c,d){if(c.onChange){var a=d.id;_.resetRun(c.$xid+"_drop",function(){a=xui.Dom.byId(a).value||"";c.$prevV=c.$prevV||"";if(a!=c.$prevV){c.boxing().onChange(c,c.$prevV,a);c.$prevV=a}})}},_prepareData:function(a){var c=arguments.callee.upper.call(this,a);if(xui.browser.kde){c._css="resize:none;"}return c},_onresize:function(e,d,a){var c=arguments.callee.upper.apply(this,arguments);e.getSubNode("BOX").cssSize(c);e.getSubNode("INPUT").cssSize(c)},insertAtCaret:function(d,f){var a=d.getSubNode("INPUT"),e=a.scrollTop()||null,c;a.onChange();c=a.caret(f);this.setCaretTo(a.get(0),c||0,e)},setCaretTo:function(a,j,f){a.focus();var e,i,d,g=xui([a]);if(_.isNumb(f)){g.scrollTop(f)}if(f===true){if(g.get(0).tagName.toLowerCase()=="textarea"&&g.scrollHeight()!==g.offsetHeight()){e=g.attr("value").substr(0,j);i=g.clone().id("").css({visibility:"hidden",position:"absolute",left:5000+"px"}).attr("value",e);xui("body").append(i);d=Math.max((i.scrollHeight()>i.offsetHeight())?i.scrollHeight()-30:0,0);g.scrollTop(d);i.remove()}}g.caret(j,j)},getParas:function(d){var s=d.getSubNode("INPUT"),A=arguments.callee,e=A.reg||(A.reg=/\r\n/g),n=s.get(0).value,h=s.caret();if(h[0]<0){h[0]=0}var z=0,u=n.substr(0,h[0]).match(e);if(u){z=u.length}n=n.replace(e,"\n");var q=n.substr(0,h[0]-z);var p=q.lastIndexOf("\n"),j=q.substr(p+1,h[0]-p),k=s.innerWidth(),t=d.getSubNode("BAK1"),r=d.getSubNode("BAK2");if(q.charAt(q.length-1)=="\n"){q+="*"}r.width(k);var i=t.html(j.replace(/ /g,"&nbsp;"),false).width(),g=r.html(q.replace(/\n/g,"<br />"),false).height()-s.scrollTop();if(i>k){r.html(j,false);var a=j;var c=r.height();while(a){a=a.replace(/ [^ ]*$/,"");r.html(a,false);if(r.height()!=c){break}}a=j.substr(a.length,j.length-a.length);i=t.html(a,true).width()}t.html("",false);r.html("",false);var f=d.getRoot().offset();f.left+=i;f.top+=g;return[h[0],j,f,s.get(0),q]}}});Class("xui.UI.TimeLine",["xui.UI","xui.absList","xui.absValue"],{Dependency:["xui.Date"],Instance:{_setCtrlValue:function(l){if(!l){return}if(l.indexOf(":")==-1){return}var e=this.get(0),c=e.properties,h=this.constructor,i=l.split(":"),j=new Date(parseInt(i[0],10)),k=new Date(parseInt(i[1],10)),g=h._getX(e,j),f=h._getX(e,k),d;if(c.items.length===0){this.insertItems([{id:"$",caption:c.dftTaskName,from:parseInt(i[0],10),to:parseInt(i[1],10)}],null,true)}else{h._resetItem(e,{left:g,width:f-g},e.getSubNodeByItemId("ITEM",c.items[0].id)._get(0))}},visibleTask:function(){var f=this.get(0),h=f.properties,e=xui.Date,d=h.items,a,g;if(!h.multiTasks){a=d.length?d[0].from:h.$UIvalue?h.$UIvalue.split(":")[0]:0;if(a){g=new Date(+a);if(f.renderId){if(g<h.dateStart||g>e.add(h.dateStart,"ms",h.width*h._rate)){h.dateStart=g;var c=h.$UIvalue;this.refresh().setUIValue(c,true)}}else{h.dateStart=g}}}return this},_afterInsertItems:function(a){if(!a.renderId){return}a.box._reArrage(a)},_afterRemoveItems:function(a){a.box._reArrage(a)},_cache:function(){var d=this.get(0),a=this.constructor,c=a._picker;if(c&&c.renderId){d.getSubNode("POOL").append(c.getRoot().css("display","none"))}},getTimeRange:function(){var a=this.get(0),c=a.properties;return[c._smallLabelStart,c._smallLabelEnd]},iniContent:function(){return this.each(function(a){var c=a.properties;a.boxing()._getContent(c._smallLabelStart,c._smallLabelEnd,c._rate,"ini");a._iniOK=true})},addTasks:function(a){return this.insertItems(a,null,true)},removeTasks:function(a){this.removeItems(a);return this},_getContent:function(e,d,c,a){return this.each(function(g){if(g.onGetContent){var f=g.boxing(),i=function(j){if(a=="ini"){f.clearItems()}f.addTasks(j)};if(g.onGetContent){var h=f.onGetContent(g,e,d,c,a,i);if(h){i(h)}}}})},scrollToLeft:function(i){var g=this.get(0);if(g.pauseA||g.pause){return}var e=g.properties,d=xui.Date,f=e._rate,h=g.box._getMoveNodes(g),c=e._band_left,a=0;if(e.minDate&&e._smallLabelStart<e.minDate){a-=d.diff(e._smallLabelStart,e.minDate,"ms")/f}g.pause=true;h.animate({left:[c,a]},null,function(){if(typeof i=="function"){i()}g.pause=false},200,Math.max(5,(a-c)/100),"sineInOut").start()},scrollToRight:function(i){var g=this.get(0);if(g.pauseA||g.pause){return}var e=g.properties,d=xui.Date,f=e._rate,h=g.box._getMoveNodes(g),c=e._band_left,a=e.width-e._band_width;if(e.maxDate&&e._smallLabelEnd>e.maxDate){a+=d.diff(e.maxDate,e._smallLabelEnd,"ms")/f}if(c>a){g.pause=true;h.animate({left:[c,a]},null,function(){if(typeof i=="function"){i()}g.pause=false},200,Math.max(5,(c-a)/100),"sineInOut").start()}}},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",style:"height:{_bHeight}px;width:{_bWidth}px;",POOL:{tagName:"div",style:"position:absolute;left:0;top:0;width:0;height:0;display:none;"},TBAR:{tagName:"div",className:"xui-uibar-top",style:"{_bardisplay};",TBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",TBARTR:{tagName:"tr",TBARTDL:{tagName:"td",className:"xui-uibar-tdl"},TBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},TBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}},BARCMDL:{tagName:"div",className:"xui-uibar-cmdl",DATE:{$order:0,style:"{dateDisplay}"},PRE:{$order:2},ZOOMIN:{$order:3,style:"{zoomDisplay}"},ZOOMOUT:{$order:4,style:"{zoomDisplay}"},NEXT:{$order:5}},BARCMDR:{tagName:"div",className:"xui-uibar-cmdr",OPT:{className:"xui-uicmd-opt",style:"{optDisplay}",$order:0},CLOSE:{$order:4,className:"xui-uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main",MAINI:{tagName:"div",className:"xui-uicon-maini",MAINC:{tagName:"div",MAINP:{tagName:"div",VIEW:{tagName:"div",style:"left:{_band_left}px;width:{_band_width}px;",BAND:{$order:2,tagName:"div",tabindex:"{tabindex}",BIGLABEL:{tagName:"div",style:"{_showBigLabel}",text:"{_bigMarks}"},SMALLLABEL:{$order:1,tagName:"div",text:"{_smallMarks}"}},CON:{$order:3,tagName:"div",style:"height:{_viewHeight}px;",BG:{tagName:"div",style:"height:{_viewHeight}px;"},LINES:{$order:1,tagName:"div"},ITEMS:{$order:2,tagName:"div",style:"height:{_viewHeight}px;",text:"{items}"}},ACTIVE:{$order:4,tagName:"div"}},SCROLL:{$order:2,tagName:"div",SCROLLI:{tagName:"div"}}}}}},TAIL:{$order:4,tagName:"div",className:"xui-uicon-main",TIPS:{className:"xui-uicon-maini",style:"z-index:2;{_tipsdisplay};",tagName:"div"}},BBAR:{$order:5,tagName:"div",style:"{_bardisplay};",className:"xui-uibar-bottom-s",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"xui-uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}}}},$submap:{_bigMarks:{LABELT:{id:null,className:null,tagName:"div",style:"width:{width}px;left:{left}px;",text:"{text}"}},_smallMarks:{LABELB:{id:null,className:null,tagName:"div",style:"width:{width}px;left:{left}px;",text:"{text}"}},bgitems:{BGITEM:{tagName:"div",style:"left:{_left}px;width:{_width}px;"}},items:{ITEM:{tagName:"div",className:"{itemClass} {disabled} {readonly} {_excls}",style:"left:{_left}px;width:{_width}px;{_top};{_zindex}{itemStyle}",HEAD:{tagName:"div",TSKBAR:{tagName:"div",style:"width:{_perw}%;"},HANDLER:{$order:2,tagName:"div",LEFT:{tagName:"div"},RIGHT:{tagName:"div"}}},BODY:{$order:1,tagName:"div",style:"{_background}",CON:{$order:3,tagName:"div",text:"{caption}"}}}}}},Behaviors:{DroppableKeys:["VIEW"],HoverEffected:{PRE:"PRE",NEXT:"NEXT",ZOOMIN:"ZOOMIN",ZOOMOUT:"ZOOMOUT",DATE:"DATE",OPT:"OPT",CLOSE:"CLOSE"},ClickEffected:{PRE:"PRE",NEXT:"NEXT",ZOOMIN:"ZOOMIN",ZOOMOUT:"ZOOMOUT",DATE:"DATE",OPT:"OPT",CLOSE:"CLOSE"},onSize:xui.UI.$onSize,CLOSE:{onClick:function(c,d,f){if(c.properties.disabled||c.properties.readonly){return}var a=c.boxing();if(false===a.beforeClose(c,f)){return}a.destroy();return false}},OPT:{onClick:function(a,c,d){if(a.properties.disabled||a.properties.readonly){return}a.boxing().onShowOptions(a,c,d)}},BAND:{onKeydown:function(g,j,c){if(g.pauseA||g.pause){return}g.pause=true;var m=g.properties,h=xui.Date,k=m._rate,i=30,d=g.box._getMoveNodes(g),l=d.left(),a=m._band_left,f=m._scroll_offset;f=m._scroll_offset=f>i?f:f*1.05;switch(xui.Event.getKey(j).key){case"left":case"up":if(m.minDate&&h.add(m.dateStart,"ms",(a-l-f)*k)<m.minDate){f=h.diff(m.minDate,m.dateStart,"ms")/k+(a-l)}if(f<0){f=0}d.left(l+f);break;case"right":case"down":if(m.maxDate&&h.add(m.dateStart,"ms",(a-l+f+m.width)*k)>m.maxDate){f=h.diff(m.dateStart,m.maxDate,"ms")/k-(a-l+m.width)}if(f<0){f=0}d.left(l-f);break}if((l+i>0)||(l+d.width()-m.width-i<0)){g.box._rePosition(g)}g.pause=false;return false},onKeyup:function(a,d){var c=a.properties;c._scroll_offset=c._scrollRate;a.box._rePosition(a)},onMousedown:function(d,h,a){if(xui.Event.getBtn(h)!="left"){return}if(d.pauseA||d.pause){return}var j=d.properties,c=-j._band_left,f=xui.Date,i=j._rate,k=xui.Event.getPos(h),g=j._band_width-c-j.width;if(j.minDate&&j._smallLabelStart<j.minDate){c-=f.diff(j._smallLabelStart,j.minDate,"ms")/i}if(j.maxDate&&j._smallLabelEnd>j.maxDate){g-=f.diff(j.maxDate,j._smallLabelEnd,"ms")/i}if(c<0){c=0}if(g<0){g=0}xui.use(a).startDrag(h,{targetReposition:false,dragType:"blank",dragDefer:2,horizontalOnly:true,targetLeft:k.left,targetTop:k.top,maxLeftOffset:g,maxRightOffset:c});xui.use(a).focus()},onDragstop:function(a,c,d){a.box._rePosition(a)},onDrag:function(d,f,g){var c=d.box._getMoveNodes(d),a=xui.DragDrop.getProfile();c.left(d.properties._band_left+a.offset.x)},onContextmenu:function(a,c,d){return a.boxing().onContextmenu(a,c,d)!==false}},SCROLL:{onScroll:function(a,c,d){a.getSubNodes(["ITEMS","LINES"]).top(-xui.use(d).scrollTop())}},VIEW:{onMouseover:function(a,c,d){if(xui.DragDrop.getProfile().isWorking){return}a.$itemspos=xui.use(d).offset()},onMousemove:function(c,f){var g=xui.DragDrop.getProfile();if(g.isWorking){if(c.$$ondrag){c.box._moveActive(c,c.$active,g.x-c.$dd_ox,c.properties._unitPixs,"move")}}else{var k=c.properties,d=xui.Date,l=k._smallLabelStart,a=k._rate,j=k._timeFormat,h=c.$itemspos;if(h&&k.showTips){var i=xui.Event.getPos(f);c.box._setTips(c,d.getText(d.add(l,"ms",(i.left-h.left)*a),j))}}},onMouseout:function(a,c,d){if(xui.DragDrop.getProfile().isWorking){return}if(a.properties.showTips){a.box._setTips(a,"")}}},ITEMS:{onMousedown:function(a,c,g){if(xui.Event.getBtn(c)!="left"){return}var f=a.properties;if(f.disabled||f.readonly){return}if(a.pauseA||a.pause){return}if(xui.Event.getSrc(c)!=xui.use(g).get(0)){return}var d=a.getSubNode("ACTIVE");d.css({width:0,visibility:"hidden"}).offset({left:xui.Event.getPos(c).left,top:null});a.__actives=1;d.startDrag(c,{dragDefer:1,dragType:"none"})},onMouseup:function(a){if(a.__actives){delete a.__actives}}},ACTIVE:{onDragbegin:function(a,c,d){a.$dd_ox=xui.DragDrop.getProfile().x;a.$dd_oleft=parseInt(xui.use(d).get(0).style.left,10)||0;xui.use(d).css("cursor","e-resize").parent().css("cursor","e-resize")},onDrag:function(d,f,i){var a=d.$dd_oleft,h=xui.DragDrop.getProfile().x,c,g;if((g=h-d.$dd_ox)>=0){c=g}else{a=a+g;c=-g}d.box._moveActive(d,xui.use(i).get(0),a,c,"all")},onDragstop:function(g,i,a){var c=g.box._deActive(g);xui.use(a).css("cursor","").parent().css("cursor","");var h=g.box,k=h._getTime(g,c.left),l=h._getTime(g,c.left+c.width),d=g.properties,f,m,j=g.boxing();if(g.properties.multiTasks){f={id:_.id(),caption:d.dftTaskName,from:k,to:l};if(g.beforeNewTask&&false===j.beforeNewTask(g,f)){}else{j.addTasks([f])}}else{j.setUIValue(k+":"+l)}g.$dd_ox=g.$dd_oleft=null}},PRE:{onClick:function(a,c){a.boxing().scrollToLeft(function(){a.box._rePosition(a)})}},NEXT:{onClick:function(a,c){a.boxing().scrollToRight(function(){a.box._rePosition(a)})}},ZOOMIN:{onClick:function(c,g){if(c.pauseA||c.pause){return}var f=c.properties,d=c.box,i=d.$zoom,a=_.arr.indexOf(i,f._unitParas),h;if(a>0){f.timeSpanKey=i[a-1][0];d._refresh(c,true)}}},ZOOMOUT:{onClick:function(c,g){if(c.pauseA||c.pause){return}var f=c.properties,d=c.box,i=d.$zoom,a=_.arr.indexOf(i,f._unitParas),h;if(a<i.length-1){f.timeSpanKey=i[a+1][0];d._refresh(c,true)}}},DATE:{onClick:function(c,g,i){if(c.pauseA||c.pause){return}var a=c.box,f=c.boxing(),j=c.properties.dateStart,h,d;if(a._picker&&a._picker.renderId){h=a._picker.boxing()}else{h=xui.create("DatePicker");a._picker=h.get(0);h.beforeClose(function(){this.boxing()._cache();return false}).beforeUIValueSet(function(n,k,e){var l=this,m=l.boxing(),n=l.properties;n.dateStart=e;m._cache()})}h.setValue(j,true).setHost(c);d=h.reBoxing();d.popToTop(i);d.setBlurTrigger(c.key+" - "+c.$xid,function(){f._cache()});xui.Event.keyboardHook("esc",0,0,0,function(){f._cache();xui.Event.keyboardHook("esc")})}},ITEM:{onClick:function(a,c,d){if(a.onClickTask){a.boxing().onClickTask(a,a.getItemByDom(d),c,d)}},onDblclick:function(a,c,d){if(a.onDblclickTask){a.boxing().onDblclickTask(a,a.getItemByDom(d),c,d)}},onDragbegin:function(d,g,i){var a=d.getItemByDom(i),c=d.$dd_type,h=c?"e-resize":"move",f=d.$active;d.$dd_ox=xui.DragDrop.getProfile().x;d.$dd_oleft=parseInt(xui.use(i).get(0).style.left,10);d.$dd_owidth=Math.min(a._realwidth,parseInt(xui.use(i).get(0).style.width,10));xui([f]).css("display","block").cssPos({left:d.$dd_oleft,top:null}).width(d.$dd_owidth-2);xui([f,f.parentNode]).css("cursor",h)},onDrag:function(f,h,a){var k,l,g=xui.DragDrop.getProfile().x-f.$dd_ox,d=f.$dd_oleft,j=f.$dd_owidth,i=f.$dd_type,c=i;if(i=="left"){if(g<j){k=d+g;l=d+j-k}else{c="right";k=d+j;l=g-j}}else{if(i=="right"){if(-g<j){k=d;l=j+g}else{c="left";k=d+g+j;l=-g-j}}else{c="move";k=d+g;l=j}}f.box._moveActive(f,f.$active,k,l,c)},onDragstop:function(a,g,h){var f=a.box,d=a.box._deActive(a),c=a.$active;var j=f._getTime(a,d.left),i=f._getTime(a,d.left+d.width);if(a.properties.multiTasks){if(a.beforeTaskUpdated&&false===a.boxing().beforeTaskUpdated(a,a.getItemByDom(h),j,i)){}else{f._resetItem(a,d,h)}}else{a.boxing().setUIValue(j+":"+i)}a.$dd_type=null;xui([c,c.parentNode]).css("cursor","")},onContextmenu:function(a,c,d){return a.boxing().onContextmenu(a,c,d)!==false}},HEAD:{onMousedown:function(a,d,g){if(xui.Event.getBtn(d)!="left"){return}var f=a.properties,c=a.getItemByDom(g);if(f.disabled||c.disabled){return}if(f.readonly||c.readonly){return}if(a.beforeDragTask&&false===a.boxing().beforeDragTask(a,c,d,g)){return}if(f.readonly||c.readonly){return}xui.use(g).parent().startDrag(d,{dragDefer:1,dragType:"none"})},onClick:function(){return false}},LEFT:{onMousedown:function(a,d,g){if(xui.Event.getBtn(d)!="left"){return}var f=a.properties,c=a.getItemByDom(g);if(f.disabled||f.readonly||c.readonly||c.disabled){return}a.$dd_type="left";xui.use(g).parent(3).startDrag(d,{dragDefer:1,dragType:"none"})}},RIGHT:{onMousedown:function(a,d,g){if(xui.Event.getBtn(d)!="left"){return}var f=a.properties,c=a.getItemByDom(g);if(f.disabled||f.readonly||c.readonly||c.disabled){return}a.$dd_type="right";xui.use(g).parent(3).startDrag(d,{dragDefer:1,dragType:"none"})}}},DataModel:{readonly:false,width:400,height:200,leftSpanCount:{ini:0,inner:1},rightSpanCount:{ini:0,inner:1},increment:0,zoomable:{ini:true,action:function(a){if(this.properties.timeSpanKey){this.getSubNodes(["ZOOMIN","ZOOMOUT"]).css("display",a?"":"none")}}},dftTaskName:"task",taskHeight:{ini:25,action:function(a){this.getSubNode("ITEM",true).height(a)}},timeSpanKey:{ini:"1 d",combobox:["10 ms","100 ms","1 s","10 s","1 n","5 n","10 n","30 n","1 h","2 h","6 h","1 d","1 w","15 d","1 m","1 q","1 y","1 de","1 c"],action:function(){this.box._refresh(this,true)}},unitPixs:0,smallLabelCount:{inner:1},smallLabelUnit:{inner:1,listbox:_.toArr(xui.Date.$TIMEUNIT,true)},smallLabelFormat:{inner:1,listbox:_.toArr(xui.Date.$TEXTFORMAT,true)},bigLabelCount:{inner:1},bigLabelUnit:{inner:1,listbox:_.toArr(xui.Date.$TIMEUNIT,true)},bigLabelFormat:{inner:1,listbox:_.toArr(xui.Date.$TEXTFORMAT,true)},timeFormat:{inner:1,listbox:_.toArr(xui.Date.$TEXTFORMAT,true)},showBar:{ini:true,action:function(c){this.getSubNode("TBAR").css("display",c?"":"none");var e=this.properties,a=e.width,d=e.height;e.width=e.height=0;xui.UI.$tryResize(this,a,d,true);e.width=a,e.height=d}},showTips:{ini:true,action:function(c){this.getSubNode("TIPS").css("display",c?"":"none");var e=this.properties,a=e.width,d=e.height;e.width=e.height=0;xui.UI.$tryResize(this,a,d,true);e.width=a,e.height=d}},showBigLabel:{ini:true,action:function(c){this.getSubNode("BIGLABEL").css("display",c?"":"none");var e=this.properties,a=e.width,d=e.height;e.width=e.height=0;xui.UI.$tryResize(this,a,d,true);e.width=a,e.height=d}},_scrollRate:5,multiTasks:{ini:false,action:function(){this.box._refresh(this,true)}},taskMinSize:60,minDate:{ini:null},maxDate:{ini:null},dateBtn:{ini:true,action:function(a){this.getSubNode("DATE").css("display",a?"":"none")}},closeBtn:{ini:false,action:function(a){this.getSubNode("CLOSE").css("display",a?"":"none")}},optBtn:{ini:false,action:function(a){this.getSubNode("OPT").css("display",a?"":"none")}},dateStart:{ini:new Date,action:function(){this.box._refresh(this,true)}}},EventHandlers:{beforeClose:function(a,c){},onShowOptions:function(a,c,d){},onGetContent:function(d,g,f,a,c,e){},onStartDateChanged:function(c,d,a){},beforeTaskUpdated:function(c,a,e,d){},beforeNewTask:function(c,a){},beforeDragTask:function(c,a,d,f){},onClickTask:function(c,a,d,f){},onDblclickTask:function(c,a,d,f){}},Appearances:{MAINI:{"padding-top":"4px"},MAINC:{border:"solid 1px #648CB4",background:"#fff"},"BARCMDL span":{$order:0,width:"15px",height:"15px",margin:"2px","vertical-align":"middle",cursor:"default"},BAND:{"outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&parseInt(xui.browser.ver,10)<3)?"-1px !important":null,"font-size":"0","line-height":"0"},"MAINP, VIEW, BAND, CON, BIGLABEL, SMALLLABEL":{position:"relative"},"MAINP, VIEW":{width:xui.browser.ie6?"100%":null,overflow:"hidden"},SCROLL:{"z-index":500,position:"absolute","font-size":"0","line-height":"0",right:0,width:"18px",overflow:"auto","overflow-x":"hidden"},SCROLLI:{height:"1000px",width:"1px"},BG:{"z-index":2,position:"absolute",left:0,top:0,width:"100%"},LINES:{"z-index":3,position:"absolute",left:0,top:0,width:"100%"},ITEMS:{"z-index":4,position:"absolute",left:0,top:0,width:"100%",overflow:"hidden"},"LINES div":{position:"relative","border-bottom":"solid 1px #7BA3CB"},"BIGLABEL, SMALLLABEL":{height:"16px","background-color":"#C8E2FC",cursor:"move","border-bottom":"solid 1px #7BA3CB"},"BIGLABEL div, SMALLLABEL div":{height:"16px","border-left":"solid 1px #7BA3CB","text-align":"center",position:"absolute",cursor:"move",top:0,overflow:"visible"},"BIGLABEL div":{$order:2,"text-align":"left","padding-left":"4px"},TIPS:{position:"relative",height:"14px","font-size":"12px","line-height":"14px","text-align":"center"},ACTIVE:{"z-index":300,"border-left":"1px dashed","border-right":"1px dashed",position:"absolute",top:0,left:"-1000px",width:0,background:0,visibility:"hidden",height:"100%"},"ZOOMIN, ZOOMOUT, DATE, PRE, NEXT":{background:xui.UI.$bg("icons.gif","no-repeat",true)},ZOOMIN:{$order:1,"background-position":"-360px -70px"},"ZOOMIN-mouseover":{$order:2,"background-position":"-360px -90px"},"ZOOMIN-mousedown":{$order:3,"background-position":"-360px -110px"},ZOOMOUT:{$order:1,"background-position":"-380px -70px"},"ZOOMOUT-mouseover":{$order:2,"background-position":"-380px -90px"},"ZOOMOUT-mousedown":{$order:3,"background-position":"-380px -110px"},DATE:{$order:1,"background-position":"-340px -70px"},"DATE-mouseover":{$order:2,"background-position":" -340px -90px"},"DATE-mousedown":{$order:3,"background-position":" -340px -110px"},PRE:{$order:1,"background-position":"-260px -70px",top:"0"},"PRE-mouseover":{$order:2,"background-position":"-260px -90px"},"PRE-mousedown":{$order:3,"background-position":"-260px -110px"},NEXT:{$order:1,position:"absolute","background-position":"-280px -70px",top:"0"},"NEXT-mouseover":{$order:2,"background-position":"-280px -90px"},"NEXT-mousedown":{$order:3,"background-position":"-280px -110px"},BGITEM:{position:"absolute",top:0,height:"100%"},ITEM:{position:"absolute",overflow:"hidden"},"HEAD, BODY":{position:"relative",overflow:"hidden","z-index":"1",border:"solid 1px #648CB4"},BODY:{$order:2,cursor:"pointer","background-color":"#F9F7D1","border-top":"none"},"HEAD, HANDLER, TSKBAR, LEFT, RIGHT":{"font-size":"1px","line-height":"1px"},HEAD:{cursor:"move","background-color":"#FFF"},HANDLER:{position:"relative",height:"7px",background:xui.UI.$bg("handler.gif","repeat #E8EEF7",true),"border-top":"solid 1px #648CB4"},TSKBAR:{position:"relative",height:"1px","background-color":"#648CB4",width:"100%"},"LEFT, RIGHT":{position:"absolute",top:0,height:"100%",width:"6px","z-index":10},LEFT:{cursor:"e-resize",left:"-1px"},RIGHT:{cursor:"w-resize",right:"-1px"},CON:{position:"relative",overflow:"hidden"},"ITEM-readonly HANDLER, ITEM-disabled HANDLER, ITEM-readonly LEFT, ITEM-disabled LEFT, ITEM-readonly RIGHT, ITEM-disabled RIGHT":{$order:2,display:"none"},"ITEM-readonly HEAD, ITEM-disabled HEAD":{cursor:"default"},"ITEM-readonly CON, ITEM-disabled CON":{$order:2,"background-color":"#E8EEF7"}},RenderTrigger:function(){var c=this,d=c.properties,a=c.box;c.$active=c.getSubNode("ACTIVE").get(0);a._ajustHeight(c)},_onDropMarkShow:function(){xui.DragDrop.setDragIcon("add");return false},_onDropMarkClear:function(){xui.DragDrop.setDragIcon("none");return false},_onDragEnter:function(d,g,h){var c=d.properties,a=xui.Event.getPos(g),f=c._unitPixs/2;xui(d.$active).css("visibility","visible");d.$dd_ox=xui.use(h).offset().left+f;d.$$ondrag=true},_onDragLeave:function(a){a.$$ondrag=a.$dd_ox=null;a.box._deActive(a)},_onDrop:function(d){d.$$ondrag=d.$dd_ox=null;var f=d.box._deActive(d),c={id:_.id(),caption:d.properties.dftTaskName},e=d.box,a=d.boxing();c.from=e._getTime(d,f.left);c.to=e._getTime(d,f.left+f.width);c._dropData=xui.DragDrop.getProfile().dragData;if(d.beforeNewTask&&false===a.beforeNewTask(d,c)){}else{a.addTasks([c])}},_prepareData:function(f){var I=f.properties,Q={},O=xui.Date,B=O.$TIMEUNIT,c="display:none",L=f.box.$zoom,K=0,E,N,F,J,g,P,a,C,h,A,H,l,y,q,n,j,D,z,v,e;Q.dateDisplay=I.dateBtn?"":c;Q.closeDisplay=I.closeBtn?"":c;Q.optDisplay=I.optBtn?"":c;Q._showBigLabel=I.showBigLabel?"":c;I._scroll_offset=I._scrollRate;I._lines=[{}];Q._bWidth=I.width;Q._bHeight=I.height;I._viewHeight=Q._bHeight;Q._tipsdisplay=I.showTips?"":c;Q._bardisplay=I.showBar?"":c;if(I.timeSpanKey){_.arr.each(L,function(d){if(d[0]===I.timeSpanKey){h=I._unitParas=d;return false}});if(!h){h=I._unitParas=L[I.timeSpanKey="1 d"]}}Q.zoomDisplay=(I.zoomable&&h)?"":c;if(h){I._unitPixs=I.unitPixs||h[1];I._smallLabelCount=I.smallLabelCount||h[2];I._smallLabelUnit=I.smallLabelUnit||h[3];I._smallLabelFormat=I.smallLabelFormat||h[4];I._bigLabelCount=I.bigLabelCount||h[5];I._bigLabelUnit=I.bigLabelUnit||h[6];I._bigLabelFormat=I.bigLabelFormat||h[7];I._timeFormat=I.timeFormat||h[8]}E=I._unitPixs;v=I._smallLabelCount;z=I._smallLabelUnit;e=I._smallLabelFormat;H=(Math.ceil(I.width/E)||0);l=I.leftSpanCount?I.leftSpanCount:H;y=I.rightSpanCount?I.rightSpanCount:H;q=H+l+y;C=I._rate=B[z]*v/E;if(I.maxDate&&O.add(I.dateStart,"ms",I.width*C)>I.maxDate){I.dateStart=O.add(I.maxDate,"ms",-I.width*C)}if(I.minDate&&I.dateStart<I.minDate){I.dateStart=I.minDate}A=O.getTimSpanStart(I.dateStart,z,v);j=I._smallLabelStart=O.add(A,z,-l*v);D=I._smallLabelEnd=O.add(j,z,q*v);I._band_width=Math.ceil(O.diff(j,D,"ms")/C);I._band_left_fix=I._band_left=-Math.ceil(O.diff(j,I.dateStart,"ms")/C);n=I._smallMarks=[];g=0;J=O.get(j,e);for(N=0;N<q;N++){P=O.add(j,z,v*(N+1));a=Math.ceil(O.diff(j,P,"ms")/C);n.push({left:g,width:a-g,text:J});g=a;J=O.getText(P,e)}if(I.showBigLabel){var o,G,s,k,R,w=I._bigLabelCount,r=I._bigLabelUnit,M=I._bigLabelFormat;s=I._bigMarks=[];k=I._bigLabelStart=O.getTimSpanStart(j,r,w);R=I._bigLabelEnd=O.getTimSpanEnd(D,r,w);o=O.diff(k,R,r)/w;G=O.diff(j,k,"ms")/C;J=O.getText(k,M);g=0;for(N=0;N<o;N++){P=O.add(k,r,w*(N+1));a=O.diff(k,P,"ms")/C;s.push({left:Math.ceil(g+G),width:Math.ceil(a-g),text:J});g=a;J=O.getText(P,M)}}return arguments.callee.upper.call(this,f,Q)},_prepareItem:function(g,h,a,d){var c=this,f=g.properties,e;if(!h.id){h.id=_.id()}if(!h.caption){h.caption=f.dftTaskName}h._realleft=h._left=c._getX(g,h.from);h._realwidth=h._width=Math.max(c._getX(g,h.to)-h._left,0);if(h._width<=f.taskMinSize){h._width=f.taskMinSize}if(h._left<0){h._left=0}if(h._left+h._width>f._band_width){h._width=f._band_width-h._left}h._perw=+(h._realwidth/h._width*100).toFixed(2);if(h._perw>=100){h._perw=100}e=c._getLinePos(g,h);h._top="top:"+(f.taskHeight+1)*(e-1)+"px";h._zindex="z-index:"+e;h._background=h.background?"background:"+h.background+";":"";h._excls=h.disabled?g.getClass("ITEM","-disabled"):h.readonly?g.getClass("ITEM","-readonly"):"";f._lines=f._lines||[{}];f._lines[e][h.id]=h;h._line=e;a._realleft=h._realleft;a._left=h._left;a._width=h._width;a._realwidth=h._realwidth;a._perw=h._perw;a._line=h._line},$zoom:[["10 ms",54,10,"ms","ms",100,"ms","hnsms","hnsms"],["100 ms",54,100,"ms","ms",1,"s","hns","hnsms"],["1 s",30,1,"s","s",10,"s","hns","hnsms"],["10 s",30,10,"s","s",60,"s","hns","hnsms"],["1 n",30,1,"n","n",10,"n","dhn","hns"],["5 n",30,5,"n","n",30,"n","mdhn","hns"],["10 n",30,10,"n","n",60,"n","mdhn","hns"],["30 n",30,30,"n","n",4,"h","ymdh","mdhn"],["1 h",30,1,"h","h",6,"h","ymdh","mdhn"],["2 h",30,2,"h","h",12,"h","ymdh","mdhn"],["6 h",30,6,"h","h",24,"h","ymd","mdhn"],["1 d",24,1,"d","w",1,"ww","ymd","ymdh"],["1 w",30,1,"ww","ww",4,"ww","ymd","ymd"],["15 d",30,15,"d","d",2,"m","ymd","ymd"],["1 m",30,1,"m","m",1,"q","yq","ymd"],["1 q",30,1,"q","q",1,"y","y","ymd"],["1 y",48,1,"y","y",10,"y","y","ym"],["1 de",48,1,"de","de",100,"y","y","ym"],["1 c",48,1,"c","c",1000,"y","y","y"]],_getTips:function(d){var a,c="$dd_tooltip";if(a=d[c]||(d[c]=d.getSubNode("TIPS").get(0).childNodes[0])){return a.nodeValue}else{return d.getSubNode("TIPS").get(0).innerHTML}},_rr:/\<[^>]*\>/g,_setTips:function(d,f,e){if(!e&&d.pauseA){return}var a,c="$dd_tooltip";f=f.replace(this._rr,"");if(a=d[c]||(d[c]=d.getSubNode("TIPS").get(0).childNodes[0])){if(a.nodeValue!=f){a.nodeValue=f}}else{d.getSubNode("TIPS").get(0).innerHTML=f}},_getX:function(c,e){var a=c.properties,f=new Date;f.setTime(e);return(Math.ceil(xui.Date.diff(a._smallLabelStart,f,"ms")||0)/a._rate)},_getTime:function(e,a,c){var d=e.properties;d=xui.Date.add(d._smallLabelStart,"ms",a*d._rate);return c?d:d.getTime()},_moveActive:function(a,e,h,j,i){var v=Math.ceil,l=a.properties,D=xui.Date,o=l._smallLabelStart,q=l._rate,k=l._timeFormat,B="ms",g=e.style,f="px",C,A,E,c=h;ww=j;if(!g.visibility||g.visibility=="hidden"){g.visibility="visible"}if(E=l.increment){if(i=="move"){h=Math.floor(c/E)*E}else{if(i=="left"||i=="all"){h=Math.floor(c/E)*E;j=ww-(h-c)}if(i=="right"||i=="all"){C=Math.floor((j+E-1)/E);j=C*E}}}C=(v(h)||0);A=((v(j)||0)-2);if(A>0){g.left=C+f;g.width=A+f;if(l.showTips){a.box._setTips(a,D.getText(D.add(o,B,h*q),k)+" - "+D.getText(D.add(o,B,(h+j)*q),k))}}g=e=null},_deActive:function(e){var d=e.$active.style,a=parseInt(d.left,10)||0,c=(parseInt(d.width,10)||0)+2;d.visibility="hidden";d.left=xui.Dom.HIDE_VALUE;d.width=0;d=null;if(e.properties.showTips){e.box._setTips(e,"")}return{left:a,width:c}},_minusLeft:function(d,c,f,e){var a=d.properties;while((e--)>0){f.first().remove();temp=c.shift()}},_minusRight:function(d,c,f,e){var a=d.properties;while((e--)>0){f.last().remove();temp=c.pop()}},_addLeft:function(a,u,m,e,c){var k=a.properties,r=xui.Date,v=u+"Marks",n=k[v],h=k[u+"LabelStart"],f=k[u+"LabelUnit"],l=k[u+"LabelCount"],d=k[u+"LabelFormat"],s=k._rate,p=[],q,g,j,o;q=0;g=r.getText(h,d);for(o=0;o<e;o++){j=r.add(h,f,l*(o+1));width=r.diff(h,j,"ms")/s;p.push({left:Math.ceil(q+(c||0)-3e-13),width:Math.ceil(width-q),text:g});q=width;g=r.getText(j,d)}p.reverse();m.prepend(a._buildItems(v,p,false));_.arr.insertAny(n,p.reverse(),0)},_addRight:function(a,j,u,n,e,c){var k=a.properties,r=xui.Date,v=u+"Marks",o=k[v],g=k[u+"LabelStart"],f=k[u+"LabelUnit"],m=k[u+"LabelCount"],d=k[u+"LabelFormat"],s=k._rate,q=[],l,h,p;l=j;for(p=0;p<e;p++){h=r.add(j,f,m*(p+1));q.push({left:Math.ceil(r.diff(g,l,"ms")/s+(c||0)-3e-13),width:Math.ceil(r.diff(l,h,"ms")/s),text:r.getText(l,d)});l=h}n.append(a._buildItems(v,q,false));_.arr.insertAny(o,q,-1)},_getMoveNodes:function(a){return a.$moveban=a.$moveban||a.getSubNode("VIEW")},_rePosition:function(e,g){e.pause=true;var w=this,E=xui.Date,r=e.properties,H=r._rate,p,A,z,j=e.getSubNode("SMALLLABEL"),u=w._getMoveNodes(e),q=g||u.left(),k=q-r._band_left_fix;if(Math.abs(k)/r._unitPixs>=1||g){var o=parseInt(k/r.unitPixs,10),I=r._smallLabelStart,l=r._smallLabelEnd,h=-o*r._smallLabelCount,v,B,f;B=r._smallLabelStart=E.add(r._smallLabelStart,r._smallLabelUnit,h);f=r._smallLabelEnd=E.add(r._smallLabelEnd,r._smallLabelUnit,h);v=Math.ceil(E.diff(B,I,"ms")/H);u.left(q-v);r._band_width=Math.ceil(E.diff(B,f,"ms")/H);_.arr.each(r.items,function(m){m._left+=v;m._realleft+=v;e.box._trimTask(e,m)});j.children().each(function(m){m.style.left=(parseFloat(m.style.left)||0)+v+"px"});_.arr.each(r._smallMarks,function(m){m.left+=v});if(o>0){w._minusRight(e,r._smallMarks,j,o);w._addLeft(e,"_small",j,o)}else{w._minusLeft(e,r._smallMarks,j,-o);w._addRight(e,l,"_small",j,-o)}if(r.multiTasks){var a=[];_.arr.each(r.items,function(m){if(m._left>=r._band_width||(m._left+m._width)<=0){delete r._lines[m._line][m.id];a.push(m.id)}});e.boxing().removeItems(a);e.boxing()._getContent(o>0?B:l,o>0?I:f,r._rate,o>0?"left":"right");w._reArrage(e)}if(r.showBigLabel){var s=e.getSubNode("BIGLABEL"),c=r._bigLabelUnit,i=r._bigLabelCount,F,D,C,d,G;l=r._bigLabelEnd;s.children().each(function(m){m.style.left=(parseFloat(m.style.left)||0)+v+"px"});_.arr.each(r._bigMarks,function(m){m.left+=v});d=E.getTimSpanStart(B,c,i);D=Math.ceil(E.diff(B,r._bigLabelStart,c)/i);C=Math.ceil(E.diff(r._bigLabelEnd,f,c)/i);if(D){F=E.diff(B,d,"ms")/H;r._bigLabelStart=d;if(D>0){w._addLeft(e,"_big",s,D,F)}else{w._minusLeft(e,r._bigMarks,s,-D)}}if(C){F=E.diff(B,d,"ms")/H;r._bigLabelEnd=E.add(r._bigLabelEnd,c,C*i);if(C<0){w._minusRight(e,r._bigMarks,s,-C)}else{w._addRight(e,l,"_big",s,C,F)}}}}r._band_left=u.left();var y=r.dateStart;r.dateStart=w._getTime(e,-r._band_left,1);if(e.onStartDateChanged){e.boxing().onStartDateChanged(e,y,r.dateStart)}e.pause=false},_trimTask:function(d,f){var a=f._realleft,c=f._realwidth,e=d.properties,g=e._band_width;if(c<=e.taskMinSize){c=e.taskMinSize}if(a<0){if(a+c<0){c=0}else{c=c+a}a=0}if(a>g){a=g}this._setItemNode(d,f,"left",a+"px");f._left=a;if(a+c>g){c=g-a}if(c>=0){if(f._width!=c){f._width=c;this._setItemNode(d,f,"width",c+"px")}}},_setItemNode:function(d,e,c,f){var a=d.getSubNodeByItemId("ITEM",e.id).get(0);a.style[c]=f},_getLinePos:function(e,f){var d=e.properties,a=false,c=0;_.arr.each(d._lines,function(g,h){if(h===0){return}a=true;_.each(g,function(i){if(f.id!==i.id){if(((f._left+f._width)>=i._left)&&((i._left+i._width)>=f._left)){return a=false}}});if(a){c=h;return false}});if(!a){c=d._lines.push({})-1}return c},_reArrage:function(e){var a=this,f,d,c=e.properties;c._lines.length=1;c.items.sort(function(g,h){return g.from>h.from?1:g.from==h.from?0:-1});_.arr.each(c.items,function(g){if(g._line===0){return}index=a._getLinePos(e,g);c._lines[index][g.id]=g;if(g._line!==index){g._line=index;if(c.multiTasks){a._setItemNode(e,g,"top",(c.taskHeight+1)*(index-1)+"px");a._setItemNode(e,g,"zIndex",index)}}});d=c._linesHeight=c._lines.length*(c.taskHeight+1);a._ajustHeight(e)},_resetItem:function(e,d,a){var c=e.properties,l=e.getItemByDom(a),g=c._band_width,h=function(f,m){return e.getSubNodeByItemId(f,m)},k=e.box,i=Math.max,j;if(d.left){l._realleft=l._left=d.left;l.from=k._getTime(e,d.left);xui.use(a).get(0).style.left=l._left+"px"}if(d.width){l.to=k._getTime(e,d.left+d.width);l._realwidth=l._width=d.width;if(l._width<=c.taskMinSize){l._width=c.taskMinSize}else{if(d.left+d.width>g){l._width=g-d.left}}xui.use(a).get(0).style.width=l._width+"px";j=+(l._realwidth/l._width*100).toFixed(2);if(j>=100){j=100}if(j!=l._perw){l._perw=j;xui.use(a).first(2).get(0).style.width=j+"%"}}k._reArrage(e)},_ajustHeight:function(c){var a=c.properties,i=function(f){return c.getSubNode(f)},k=i("CON"),j=i("ITEMS"),o=i("LINES"),e,l,m=a._linesHeight||0,d=k.height();e=Math.max(m,d);l=m>d;i("SCROLLI").height(e);i("SCROLL").css("display",l?"block":"none");j.height(e);o.height(e);j.top(l?-i("SCROLL").scrollTop():0);o.top(l?-i("SCROLL").scrollTop():0);var g=parseInt(e/a.taskHeight,10)+1,n=i("LINES").get(0).childNodes.length;if(n<g){i("LINES").append(xui.create(_.str.repeat('<div style="height:'+a.taskHeight+'px;"></div>',g-n)))}},_showTips:function(g,f,h){if(g.properties.disableTips){return}if(g.onShowTips){return g.boxing().onShowTips(g,f,h)}if(!xui.Tips){return}var k=g.properties,c=f.id,i=k._timeFormat,d=g.getSubId(c),a=g.SubSerialIdMapItem,j=a&&a[d],e=xui.Date;if(k.disabled){return}if(j&&j.disabled){return}if(j){j.tips='<p style="font-weight:bold">'+j.caption+"</p>"+e.getText(new Date(j.from),i)+" - "+e.getText(new Date(j.to),i);xui.Tips.show(h,j);return true}else{return false}},_beforeSerialized:function(c){var a=c.properties.width,d=arguments.callee.upper.call(this,c);d.properties.width=a;return d},_onresize:function(d,q,m){var j=d.properties,r=function(f){return d.getSubNode(f)},l=r("BBAR").height(),i=r("TAIL").height(),p=r("CON").offset(null,d.getRoot()),o=2,h,k;if(m&&d._$h!=m){r("BORDER").height(d._$h=k=m);r("CON").height(k=k-(j.showTips?i:0)-p.top-(j.showBar?l:0)-o);h=r("BAND").height();r("SCROLL").top(h).height(k+h);d.getSubNodes(["BG","ITEMS","SCROLL"]).height(k);this._ajustHeight(d);if(xui.browser.ie6){r("ACTIVE").height(r("VIEW").height()+2)}}if(q&&d._$w!=q){r("BORDER").width(d._$w=j.width=q);var c=d.boxing(),n=c.getItems("data"),u=j._smallLabelStart,g=j._smallLabelEnd,e,s;this._refresh(d);e=u-j._smallLabelStart;if(!j.multiTasks){s=j.$UIvalue}c.setItems(n);if(!j.multiTasks){c.setUIValue(s,true)}else{var a=[];_.arr.each(j.items,function(f){if(f._left>=j._band_width||(f._left+f._width)<=0){delete j._lines[f._line][f.id];a.push(f.id)}});c.removeItems(a)}if(e>0){if(!d._iniOK){c.iniContent()}else{c._getContent(j._smallLabelStart,u,j._rate,"left");c._getContent(g,j._smallLabelEnd,j._rate,"right")}}this._reArrage(d)}},_refresh:function(e,f){var g=e.properties,d=e.boxing(),a,c;if(!g.multiTasks){c=g.$UIvalue}d.clearItems();this._prepareData(e);a=e._buildItems("_smallMarks",g._smallMarks,false);e.getSubNode("SMALLLABEL").empty().append(a);if(g.showBigLabel){a=e._buildItems("_bigMarks",g._bigMarks,false);e.getSubNode("BIGLABEL").empty().append(a)}e.getSubNode("VIEW").left(g._band_left).width(g._band_width);if(!g.multiTasks){d.setUIValue(c,true)}else{if(f){d.iniContent()}}return this}}});Class("xui.UI.TagEditor",["xui.UI","xui.absValue"],{Dependency:["xui.UI.Input"],Instance:{activate:function(){var a=this.getTagInput(0);if(a&&a.get(0)){a.activate()}return this},getTagInput:function(a){var d=this.get(0),c=null;if(d.__inputs){if(_.isNumb(a)){if(c=d.__inputs[a]){c=c.boxing()}}else{c=xui.UI.Input.pack(d.__inputs,false)}}return c},_setDirtyMark:function(){arguments.callee.upper.apply(this,arguments);return this.each(function(a){if(a.beforeFormatMark&&false===box.beforeFormatMark(a,a._inValid==2)){}else{a.getSubNode("ERROR").css("display",a._inValid==2?"block":"none")}})}},Static:{$valuemode:"multi",Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",className:"{_bordertype}",ITEMS:{$order:10,tagName:"div",style:"{_padding}",text:"{items}"}},ERROR:{$order:2}},Appearances:{KEY:{"font-size":"12px"},ITEMS:{position:"relative",overflow:"hidden"},BORDER:{position:"relative",overflow:"hidden"},ERROR:{width:"16px",height:"16px",position:"absolute",right:"2px",top:"2px",display:"none","font-size":0,background:xui.UI.$bg("icons.gif","no-repeat left -244px",true),"z-index":"50"}},Behaviors:{onSize:xui.UI.$onSize},DataModel:{selectable:true,borderType:{ini:"flat",listbox:["none","flat","inset","outset"],action:function(c){var e=this,h=e.properties,f=e.getSubNode("BORDER"),d=/^xui-uiborder-/,g="xui-uiborder-",a=e.getRoot();f.removeClass(d);f.addClass(g+c);xui.UI.$tryResize(e,a.get(0).style.width,a.get(0).style.height,true)}},valueSeparator:{ini:",",action:function(){}},padding:{ini:"4px",action:function(a){this.getSubNode("ITEMS").css("padding",a)}},valueFormat:{ini:"",action:function(a){var c=this.boxing().getTagInput();if(c){c.setValueFormat(a)}}},required:{ini:false},tagCount:{ini:3,action:function(a){this.boxing().refresh()}},tagMaxlength:{ini:6,action:function(a){var c=this.boxing().getTagInput();if(c){c.setMaxlength(a)}}},tagInputWidth:{ini:80,action:function(a){var c=this.boxing().getTagInput();if(c){c.setWidth(a)}}},tagInputHeight:{ini:22,action:function(a){var c=this.boxing().getTagInput();if(c){c.setHeight(a)}}},tagSpacing:{ini:6,action:function(a){var c=this.boxing().getTagInput();if(c){c.setCustomStyle("KEY","margin-right:"+(parseInt(a,10)||0)+"px;margin-bottom:"+(parseInt(a,10)||0)+"px;")}}},width:300,height:32},RenderTrigger:function(){this.$onValueSet=this.$onUIValueSet=function(c){c=c.split(this.properties.valueSeparator);_.arr.each(this.__inputs,function(e,d){e.boxing().setValue(c[d]||"",true)})};var a=this.boxing().getTagInput();if(a){a.render(true)}},_checkValid:function(a,c){if(a.properties.required&&(!c||!c.replace(new RegExp("\\s*\\"+a.properties.valueSeparator+"\\s*","img"),""))){a._inValid=2;return false}else{a._inValid=3}return true},_ensureValue:function(d,f){var g=d.properties,a=[];if(!f){f=""}if(_.isStr(f)){f=f.split(g.valueSeparator)}for(var c=0,e;c<g.tagCount;c++){e=f[c];if(!e){e=""}if(e.length>g.tagMaxlength){e=e.slice(0,g.tagMaxlength)}e=_.str.trim(e);if(e){a.push(e)}}return a.join(g.valueSeparator)},_prepareData:function(d){var f=arguments.callee.upper.call(this,d);f._bordertype="xui-uiborder-"+f.borderType;var a=d.properties,g=[],h,l,c,j;if(a.padding){f._padding="padding:"+a.padding}var k=this._ensureValue(d,a.value).split(a.valueSeparator);if(a.tagSpacing){c={KEY:"margin-right:"+a.tagSpacing+"px;margin-bottom:"+a.tagSpacing+"px;"}}h={position:"relative",width:a.tagInputWidth,height:a.tagInputHeight,maxlength:a.tagMaxlength,valueFormat:a.valueFormat,dirtyMark:false};for(var e=0;e<a.tagCount;e++){h.value=k[e]||"";j=(new xui.UI.Input(h,l,null,d.theme,c)).get(0);j.$onUIValueSet=function(n){var m=this,o,i=[];_.arr.each(d.__inputs,function(t,s){i.push(_.str.trim(t.boxing().getUIValue()||""));if(t===m){o=s}});_.filter(i,function(t,s){return t.replace(/\s+/g,"")!==""});var q=d.properties.valueSeparator,r=i.join(q);var p=d._inValid;d.boxing().setUIValue(r);a.$UIvalue=r;if(p!==d._inValid){if(d.renderId){d.boxing()._setDirtyMark()}}return r.split(q)[o]||""};g.push(j)}f.items=xui.UI.Input.pack(g,false).toHtml();d.__inputs=g;return f},_onresize:function(e,d,a){var c=e.properties.borderType!="none"?2:0;if(a){e.getSubNode("BORDER").height(a=="auto"?a:(a-c))}if(d){e.getSubNode("BORDER").width(d=="auto"?d:(d-c))}}}});Class("xui.UI.FoldingTabs","xui.UI.Tabs",{Instance:{_setCtrlValue:function(a,c){this.each(function(f){var e=f.domId,g=f.boxing(),k=c?"":g.getUIValue(),d=f.properties,h=function(r,n){var p=f.getSubIdByItemId(r),q=f.getItemByItemId(r);if(p){n.push(p);var o=f.getSubNode("BODY",p);if(o.css("display")!="none"){q._scrollTop=o.get(0).scrollTop||0;if(q._scrollTop){o.get(0).scrollTop=0}o.css("display","none")}}},l=function(r,n){var p=f.getSubIdByItemId(r),q=f.getItemByItemId(r);if(p){n.push(p);var o=f.getSubNode("BODY",p);if(o.css("display")=="none"){o.css("display","block");if(q._scrollTop){o.get(0).scrollTop=q._scrollTop}f.box._forLazyAppend(f,q,r);f.box._forIniPanelView(f,q,r)}}};var j=[],i=[];if(d.selMode=="multi"){k=k?k.split(d.valueSeparator):[];a=a?a.split(d.valueSeparator):[];_.arr.each(k,function(n){if(_.arr.indexOf(a,n)==-1){h(n,j)}});_.arr.each(a,function(n){if(_.arr.indexOf(k,n)==-1){l(n,i)}})}else{h(k,j);l(a,i)}if(j.length){f.getSubNodes(["ITEM","TOGGLE"],j).tagClass("-checked",false);f.getSubNodes("ITEM",j).next().tagClass("-prechecked",false)}if(i.length){f.getSubNodes(["ITEM","TOGGLE"],i).tagClass("-checked");f.getSubNodes("ITEM",i).next().tagClass("-prechecked")}var m=f.getRootNode().style;xui.UI.$tryResize(f,m.width,m.height,true)})},_afterInsertItems:null},Static:{Templates:{tagName:"div",style:"{_style};",BOX:{$order:0,tagName:"div",className:"xui-uibg-base",ITEMS:{tagName:"div",text:"{items}"}},$submap:{items:{ITEM:{tagName:"div",className:"{_checked} {_precheked} {itemClass} {disabled} {readonly}",style:"{itemDisplay} {itemStyle}",HANDLE:{tagName:"div",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tabindex:"{_tabindex}",TLEFT:{$order:0,tagName:"div",TOGGLE:{$order:0,className:"xui-uicmd-toggle {_tlgchecked}"},ICON:{$order:2,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:3,text:"{caption}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",MESSAGE:{$order:0,text:"{message}"},CMDS:{$order:2,OPT:{$order:1,className:"xui-uicmd-opt",style:"{_opt}"},POP:{className:"xui-uicmd-pop",style:"{popDisplay}",$order:1},CLOSE:{className:"xui-uicmd-close ",style:"{closeDisplay}",$order:2}}}}},BODY:{$order:1,tagName:"div",BODYI:{tagName:"div",PANEL:{tagName:"div",style:"{_itemHeight}",className:"xui-uibg-base",text:xui.UI.$childTag}}},TAIL:{$order:4,tagName:"div",TL:{tagName:"div"},TR:{tagName:"div"}}}}}},Appearances:{KEY:{},BOX:{},ITEMS:{border:0,position:"relative",zoom:xui.browser.ie?1:null,"padding-top":"8px"},ITEM:{border:0,zoom:xui.browser.ie?1:null,"margin-top":"-9px",padding:0,"font-family":'"Verdana", "Helvetica", "sans-serif"',position:"relative",overflow:"hidden"},"HANDLE, BODY, BODYI, PANEL, TAIL":{position:"relative"},CMDS:{padding:"2px 0 0 4px","vertical-align":"middle",position:"relative"},BODY:{display:"none","border-right":"solid 1px #CCC",zoom:xui.browser.ie?1:null,position:"relative",overflow:"auto",background:xui.UI.$bg("border_left.gif","repeat-y left top","FoldingList")},BODYI:{padding:"0 8px",background:xui.UI.$bg("border_left.gif","repeat-y left top","FoldingList")},PANEL:{overflow:"auto",padding:"2px"},"ITEM-mouseover":{},"ITEM-mousedown, ITEM-checked":{},"ITEM-checked":{$order:2,"margin-bottom":"12px"},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute","font-size":0,"line-height":0,width:"8px",background:xui.UI.$bg("corner.gif","no-repeat","FoldingList")},"HL, HR":{height:"30px"},"ITEM-prechecked HL":{$order:1,"background-position":"left top"},"ITEM-prechecked HR":{$order:1,"background-position":"right top"},"TL, TR":{height:"20px"},HL:{$order:1,top:0,left:0,"background-position":"left -37px"},HR:{$order:1,top:0,right:0,"background-position":"right -37px"},TL:{$order:1,bottom:0,left:0,"background-position":"left bottom"},TR:{$order:1,bottom:0,right:0,"background-position":"right bottom"},HANDLE:{position:"relative",zoom:xui.browser.ie?1:null,background:xui.UI.$bg("border_top.gif","#fff repeat-x left top","FoldingList"),overflow:"hidden"},TITLE:{$order:1,height:"26px",display:"block",position:"relative","white-space":"nowrap",overflow:"hidden"},"BODY, BODYI, PANEL":{"font-size":0,"line-height":0},TAIL:{"font-size":0,"line-height":0,height:"5px",background:xui.UI.$bg("border_bottom.gif","repeat-x left bottom #EEE","FoldingList")},"CAPTION, MESSAGE":{padding:"3px","vertical-align":"middle"},CAPTION:{color:"#666",cursor:"pointer","white-space":"nowrap",font:"12px arial,sans-serif",color:"#00681C"},"ITEM-checked CAPTION":{$order:2,"font-weight":"bold"},TLEFT:{position:"absolute",left:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"}},Behaviors:{DraggableKeys:["HANDLE"],HoverEffected:{OPT:"OPT",CLOSE:"CLOSE",POP:"POP"},ClickEffected:{OPT:"OPT",CLOSE:"CLOSE",POP:"POP"},ITEM:{onClick:null,onMousedown:null},ITEMS:{onMousedown:null,onDrag:null,onDragstop:null},HANDLE:{onClick:function(f,j,a){if(xui.Event.getBtn(j)!="left"){return false}var c=f.properties,n=f.getItemByDom(a),k=f.getSubId(a),i=f.boxing(),g,d;if(c.disabled||n.disabled){return false}if(c.readonly||n.readonly){return false}f.getSubNode("TITLE").focus();switch(c.selMode){case"multi":var m=i.getUIValue(),h=m?m.split(c.valueSeparator):[],l=1;if(h.length){d=false;if(_.arr.indexOf(h,n.id)!=-1){_.arr.removeValue(h,n.id);l=-1}else{h.push(n.id)}h.sort();m=h.join(c.valueSeparator);if(i.getUIValue()==m){g=false}else{i.setUIValue(m);if(i.get(0)&&i.getUIValue()==m){g=i.onItemSelected(f,n,j,a,l)||d}}break}case"single":if(i.getUIValue()==n.id){g=false}else{i.setUIValue(n.id);if(i.get(0)&&i.getUIValue()==n.id){g=i.onItemSelected(f,n,j,a,1)}}break}return g},onKeydown:function(d,g,h){var f=xui.Event.getKey(g),c=f.key,a=f.shiftKey;if(c==" "||c=="enter"){d.getSubNode("HANDLE",d.getSubId(h)).onClick();return false}}}},DataModel:{$border:0,noPanel:null,HAlign:null,selMode:{ini:"single",listbox:["single","multi"]}},_prepareItems:function(d,a,c){if(a.length){a[0]._precheked=d.getClass("ITEM","-prechecked")}return arguments.callee.upper.apply(this,arguments)},_prepareItem:function(a,c){var f="display:none";c.closeDisplay=c.closeBtn?"":f;c.popDisplay=c.popBtn?"":f;c._opt=c.optBtn?"":f;c.itemDisplay=c.hidden?f:"";if(c.height&&c.height!="auto"){c._itemHeight="height:"+c.height+"px;"}var e=a.properties,d;c._tabindex=e.tabindex;if(!c.caption){c._capDisplay=f}else{c.caption=c.caption.replace(/</g,"&lt;")}if(c._show){c._checked=a.getClass("ITEM","-checked");c._tlgchecked=a.getClass("TOGGLE","-checked")}},_onresize:function(e,d,a,f,c){if(f){e._w=e._h=null}if(d&&e._w!=d){e._w=d;e.getSubNode("PANEL",true).each(function(g){if(g.offsetWidth){xui(g).width("auto").width(xui(g).width())}})}},_adjustScroll:null}});Class("xui.UI.Poll","xui.UI.List",{Instance:{fillContent:function(f,e){var c=this.get(0),a,d;if(c.renderId){if(d=c.getItemByItemId(f)){a=c.getSubNodeByItemId("BODY",f).html("");if(e){d._obj=e;d._fill=true;if(typeof e=="string"){a.html(e)}else{a.append(e.render(true))}}else{d._obj=d._fill=null}}}return this},_setOptCap:function(a,c){return this.each(function(f){var d=f.properties.items,e=f.queryItems(f.properties.items,function(g){return g.id==a.id},false,true);if(e&&(e=e[0])){e.caption=c;if(f.renderId){f.getSubNodeByItemId("CAPTION",e.id).html(c)}}})},getBindEditor:function(){return this.get(0)._bind},_insertOpt:function(a){if(!a.id){a.id="$"+_()}this.insertItems([a]);return this},_removeOpt:function(a){this.removeItems([a],"OUTER");return this},_setDirtyMark:function(){return this}},Initialize:function(){var c=this;c.addTemplateKeys(["EDIT"]);var d=c.getTemplate();d.TITLE={$order:2,tagName:"DIV",style:"{titleDisplay}",text:"{title}",className:"xui-uibg-bar xui-uiborder-outset {disabled} {_cls}"};d.TAIL={$order:20,tagName:"DIV",className:"xui-uibg-bar xui-uiborder-outset {disabled}",text:"{cmds}"};d.$submap={items:{OUTER:{tagName:"div",className:"xui-uibg-bar xui-uiborder-outset",TOGGLE:{className:"xui-uicmd-toggle",style:"{_togdisplay}"},ITEM:{tabindex:"{_tabindex}",className:"{itemClass} {disabled}",style:"{itemStyle}",OPTION:{$order:0,tagName:"DIV",MARK2:{$order:1,className:"{_optclass}"}},CAPTION:{$order:1,tagName:"DIV",text:"{caption}",className:"{disabled} {_itemcls}"},CHART:{$order:2,tagName:"DIV",style:"{_display}",CAST:{$order:0,text:"{message}"},PROGRESS:{$order:1,style:"background-position: -{_per}px -200px;",PROGRESSI:{}},DEL:{$order:2,className:"xui-ui-btn",style:"{_del}",DELI:{className:"xui-ui-btni",DELC:{className:"xui-ui-btnc",DELA:{tagName:"button",text:"{removeText}"}}}}},CLEAR:{$order:3,tagName:"DIV"}},BODY:{$order:1,tagName:"DIV",text:"{_body}"}}},cmds:{CMD:{className:"xui-ui-btn",CMDI:{className:"xui-ui-btni",CMDC:{className:"xui-ui-btnc",CMDA:{tabindex:"{_tabindex}",text:"{caption}"}}}}}};d.ITEMS.className="";c.setTemplate(d);var e=function(k,j,m,n,q){var i,l,g=k.properties,p=function(r){var o=k.boxing();switch(m){case"1":if(o.beforeOptionChanged(k,q,r)!==false){o._setOptCap(q,r)}break;case"2":if(o.beforeOptionAdded(k,r)!==false){var s="["+r.replace(/[^\w_]*/g,"")+"]";o._insertOpt({caption:r,id:s});if(!k.properties.editable){k.boxing().fireItemClickEvent(s)}}break;default:if(o.beforeTitleChanged(k,r)!==false){o.setTitle(r)}}};if(k.onCustomEdit){if(i=k._bind=k.boxing().onCustomEdit(k,j,m,n,q,p)){l=true}}if(!l){i=k._bind;if(!i){var h={type:g.editorType,commandBtn:"save",left:-10000,top:-10000};k._bind=i=xui.create("ComboInput",h);i.onHotKeydown(function(r,o){if(o.key=="enter"){r.boxing().onCommand(r);return false}else{if(o.key=="esc"){i.hide();return false}}});k.getRoot().append(i)}var f=j.cssRegion(true,k.getRoot());if(f.height>i.getHeight()){i.setHeight(f.height)}else{f.top-=3}if(f.top<0){f.top=0}i.setValue(n||"",true).setWidth(f.width+(parseInt(j.css("paddingLeft"),10)||0)+(parseInt(j.css("paddingRight"),10)||0)).onCommand(function(s){var t=s.properties,o=t.$UIvalue,r=t.value;if(o!=r){p(o)}_.asyRun(function(){i.hide()})}).reBoxing().setBlurTrigger(i.KEY+":"+i.$xid,function(){i.hide()}).show(f.left+"px",f.top+"px");_.asyRun(function(){i.activate()})}};d=c.getBehavior();var a=d.ITEM.onClick;d.ITEM.onClick=function(g,j,k){var i=g.properties,h=g.getItemByDom(k),f=h.id=="$custom"||h.editable;if(i.disabled){return}if(i.editable){e(g,g.getSubNodeByItemId("CAPTION",h.id),f?"2":"1",f?"":h.caption,h)}else{if(f){e(g,g.getSubNodeByItemId("CAPTION",h.id),"2")}else{a.apply(this,arguments)}}};d.TITLE={onClick:function(f,i,j){var h=f.properties,g=f.getItemByDom(j);if(h.disabled){return}if(h.editable){e(f,f.getSubNode("TITLE"),"3",h.title)}}};d.DEL={onClick:function(g,j,k){var i=g.properties,f=g.boxing(),h=g.getItemByDom(k);if(i.disabled){return}if(f.beforeOptionRemoved(g,h)!==false){f._removeOpt(h.id)}return false}};d.CMD={onClick:function(g,i,j){var h=g.properties,f=g.getSubId(j);if(h.disabled){return}g.boxing().onClickButton(g,f,j)}};d.TOGGLE={onClick:function(i,k,g){var l=i.properties,m=l.items,q=i.getItemByDom(g),n=i.getSubId(g),h=xui.use(g),j=i.getSubNode("BODY",n),p;if(q._show){h.tagClass("-checked",false);j.css("display","none")}else{h.tagClass("-checked");j.css("display","block");if(!q._fill){q._fill=true;var o=function(r){i.boxing().fillContent(q.id,q._body=r)};if(i.onGetContent){var f=i.boxing().onGetContent(i,q,o);if(f){o(f)}}else{o(i.box._buildBody(i,q))}}}q._show=!q._show}};c.setBehavior(d)},Static:{_DIRTYKEY:"MARK2",_ITEMKEY:"OUTER",Appearances:{KEY:{"font-size":"12px",zoom:xui.browser.ie?1:null},"TITLE, ITEMS, TAIL":{position:"relative",overflow:"auto","line-height":"14px"},TAIL:{zoom:xui.browser.ie?1:null,padding:"5px 0 5px 40px"},CMD:{margin:"3px","white-space":"nowrap","vertical-align":"middle"},TITLE:{"font-weight":"bold",padding:"4px"},ITEMS:{"overflow-x":"hidden",zoom:xui.browser.ie?1:null},OUTER:{position:"relative",zoom:xui.browser.ie?1:null,"padding-left":"15px"},TOGGLE:{position:"absolute",left:0,top:"4px"},BODY:{display:"none","padding-left":"27px"},ITEM:{display:"block",position:"relative",zoom:xui.browser.ie?1:null,padding:"4px 2px 4px 2px"},OPTION:{position:"absolute",left:"2px",top:"4px"},CAPTION:{"float":"left",zoom:xui.browser.ie?1:null,"margin-left":"24px",display:xui.browser.ie6?"inline":null},"EDIT, EDITS":{$order:2,"float":"none","background-color":"#EBEADB",cursor:"pointer",display:xui.browser.ie6?"block":null},CHART:{"float":"right"},CLEAR:{clear:"both","text-align":"right"},"PROGRESS, PROGRESSI":{background:xui.UI.$bg("icons.gif","no-repeat",true),width:"200px",height:"14px",border:0,"vertical-align":"middle","line-height":0,"font-size":0},PROGRESS:{$order:1,"margin-left":"2px","background-position":"-180px -200px"},PROGRESSI:{$order:1,"background-position":"-200px -216px"},DEL:{margin:"0 0 0 4px"}},DataModel:{$checkbox:1,selectable:true,noCtrlKey:null,title:{action:function(a){this.getSubNode("TITLE").html(a)}},selMode:{ini:"single",listbox:["single","multi"],action:function(){this.boxing().refresh()}},cmds:{ini:[]},noTitle:{ini:false,action:function(a){this.getSubNode("TITLE").css("display",a?"none":"")}},toggle:{ini:false,action:function(a){this.getSubNode("TOGGLE",true).css("display",a?"":"none")}},removeText:{ini:"remove",action:function(a){this.getSubNode("DEL",true).text(a)}},editable:{ini:false,action:function(d){var c=this,e,a;c.getSubNode("DEL",true).css("display",d?"":"none");e=c.getSubNode("CAPTION",true).merge(c.getSubNode("TITLE"));a=c.getClass("EDIT");if(d){e.addClass(a)}else{e.removeClass(a)}}},newOption:{ini:"",action:function(d){var c=this,g="$custom",a="_special",e,f=c._cs;if(!d){if(f){f.remove()}}else{if(!f){e={id:g,caption:d};e[xui.UI.$tag_subId]=a;f=c._buildItems("items",c.box._prepareItems(c,[e]));c.getSubNode("ITEMS").addNext(c._cs=f)}else{c.getSubNodeByItemId("CAPTION",a).html(d)}}}},editorType:"none"},Behaviors:{HoverEffected:{DEL:"DEL",CMD:"CMD",ITEM:"MARK2"},ClickEffected:{DEL:"DEL",CMD:"CMD",ITEM:"MARK2"}},EventHandlers:{beforeTitleChanged:function(a,c){},beforeOptionAdded:function(a,c){},beforeOptionRemoved:function(a,c){},beforeOptionChanged:function(a,c,d){},onCustomEdit:function(c,e,a,f,d,g){},onClickButton:function(c,a,d){},onGetContent:function(a,c,d){}},RenderTrigger:function(){var a=this,c=a.properties.newOption;if(c){a.boxing().setNewOption(c,true)}},_prepareData:function(g){var j=arguments.callee.upper.call(this,g),d=g.properties;if(d.editable){j._cls=g.getClass("EDIT")}j.titleDisplay=d.noTitle?"display:none":"";var c=d.cmds,f;if(c&&c.length){var e=xui.UI.$tag_subId,m;m=j.cmds=[];for(var k=0,n=c,h=n.length;k<h;k++){if(typeof n[k]=="string"){n[k]={id:n[k]}}if(!n[k].caption){n[k].caption=n[k].id}n[k].id=n[k].id.replace(/[^\w]/g,"_");f=xui.UI.adjustData(g,n[k]);m.push(f);f._tabindex=d.tabindex;f[e]=f.id}}return j},_prepareItem:function(a,c){var e=a.properties,d=a.CF;c._tabindex=e.tabindex;if(typeof d.formatCaption=="function"){c.caption=d.formatCaption(c.caption)}c._body=c._body||"Loading...";if(c.id!="$custom"){c._togdisplay=((e.toggle&&c.toggle!==false)||c.toggle)?"":"display:none;";c._optclass=e.selMode=="multi"?"xui-uicmd-check":"xui-uicmd-radio";c._display="";c.percent=parseFloat(c.percent)||0;if(c.percent<0){c.percent=0}if(c.percent>1){c.percent=1}c._per=200*(1-c.percent)}else{c._optclass="xui-uicmd-add";c._togdisplay=c._display="display:none;";c._per=0;c._itemcls=a.getClass("EDITS")}c.removeText=e.removeText;c._del="display:none;";if((("editable" in c)&&c.editable)||e.editable){c._itemcls=a.getClass("EDIT");c._del=""}},_buildBody:function(a,c){return c.text?"<pre>"+c.text.replace(/</g,"&lt;")+"</pre>":""},_onresize:function(){}}});Class("xui.UI.FoldingList",["xui.UI.List"],{Instance:{fillContent:function(f,e){var c=this.get(0),a,d;if(c.renderId){if(d=c.getItemByItemId(f)){a=c.getSubNodeByItemId("BODYI",f).html("");if(e){d._obj=e;d._fill=true;if(typeof e=="string"){a.html(e)}else{a.append(e.render(true))}}else{d._obj=d._fill=null}}}return this},toggle:function(d){var f=this.get(0);if(f.renderId){var h=f.properties,i=h.items,m=f.getItemByItemId(d),c=f.getSubIdByItemId(d),e=f.getSubNode("ITEM",c),g=f.getSubNode("TOGGLE",c),j=e.next(),l;if(m._show){if(h.activeLast&&i.length){if(i[i.length-1].id==m.id){return false}}e.tagClass("-checked",false);g.tagClass("-checked",false);if(j){j.tagClass("-prechecked",false)}}else{e.tagClass("-checked");g.tagClass("-checked");if(j){j.tagClass("-prechecked")}if(!m._fill){var k=function(n){f.boxing().fillContent(m.id,m._body=n)};if(f.onGetContent){var a=f.boxing().onGetContent(f,m,k);if(a){k(a)}}else{k(f.box._buildBody(f,m))}}}m._show=!m._show}return this}},Initialize:function(){var a=this.getTemplate();a.$submap={items:{ITEM:{tagName:"div",className:"{_checked} {_precheked} {itemClass} {disabled} {readonly}",style:"{itemStyle}",HEAD:{tagName:"div",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tabindex:"{_tabindex}",TLEFT:{$order:0,tagName:"div",TOGGLE:{$order:0,className:"xui-uicmd-toggle {_tlgchecked}"},CAP1:{$order:1,text:"{title}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",CAP2:{$order:0,text:"{caption}"},OPT:{$order:1,className:"xui-uicmd-opt",style:"{_opt}"}}}},BODY:{$order:1,tagName:"div",className:"xui-uibg-base",BODYI:{$order:0,tagName:"div",text:"{_body}"},CMDS:{$order:1,tagName:"div",text:"{cmds}"}},TAIL:{$order:4,tagName:"div",TL:{tagName:"div"},TR:{tagName:"div"}}}},"items.cmds":{$order:2,CMD:{className:"xui-ui-btn",CMDI:{className:"xui-ui-btni",CMDC:{className:"xui-ui-btnc",CMDA:{tabindex:"{_tabindex}",text:"{caption}"}}}}}};this.setTemplate(a)},Static:{Appearances:{KEY:{padding:"2px"},ITEMS:{border:0,position:"relative",zoom:xui.browser.ie?1:null,"padding-top":"8px"},ITEM:{border:0,zoom:xui.browser.ie?1:null,"margin-top":"-9px",padding:0,"font-family":'"Verdana", "Helvetica", "sans-serif"',position:"relative",overflow:"hidden"},"HEAD, BODY, BODYI, TAIL":{position:"relative"},CMDS:{"font-size":0,"line-height":0,padding:"2px 0 0 4px","text-align":"right",position:"relative",background:xui.UI.$bg("border_left.gif","repeat-y left top #EEE"),zoom:xui.browser.ie?1:null},CMD:{margin:"2px 4px 2px 4px"},BODY:{display:"none","border-right":"solid 1px #CCC",zoom:xui.browser.ie?1:null,position:"relative",overflow:"auto",background:xui.UI.$bg("border_left.gif","repeat-y left top")},BODYI:{padding:"2px 8px 0 8px",background:xui.UI.$bg("border_left.gif","repeat-y left top"),position:"relative"},"BODY, BODYI":{"font-size":0,"line-height":0},"ITEM-checked":{$order:2,"margin-bottom":"12px"},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute","font-size":0,"line-height":0,width:"8px",background:xui.UI.$bg("corner.gif","no-repeat")},"HL, HR":{height:"30px"},"ITEM-prechecked HL":{$order:1,"background-position":"left top"},"ITEM-prechecked HR":{$order:1,"background-position":"right top"},"TL, TR":{height:"20px"},HL:{$order:1,top:0,left:0,"background-position":"left -37px"},HR:{$order:1,top:0,right:0,"background-position":"right -37px"},TL:{$order:1,bottom:0,left:0,"background-position":"left bottom"},TR:{$order:1,bottom:0,right:0,"background-position":"right bottom"},HEAD:{position:"relative",zoom:xui.browser.ie?1:null,background:xui.UI.$bg("border_top.gif","#fff repeat-x left top"),overflow:"hidden"},TITLE:{$order:1,height:"26px",display:"block",position:"relative","white-space":"nowrap",overflow:"hidden"},TAIL:{"font-size":0,"line-height":0,position:"relative",height:"5px",background:xui.UI.$bg("border_bottom.gif","repeat-x left bottom #EEE")},"CAP1, CAP2":{padding:"3px","vertical-align":"middle"},CAP1:{color:"#666",cursor:"pointer","white-space":"nowrap",font:"bold 12px arial,sans-serif",color:"#00681C"},"ITEM-checked CAP1":{$order:2,"font-weight":"normal"},TLEFT:{position:"absolute",left:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:"4px",top:"2px","white-space":"nowrap",overflow:"hidden"}},Behaviors:{HoverEffected:{ITEM:null,HEAD:"HEAD",OPT:"OPT",CMD:"CMD"},ClickEffected:{ITEM:null,HEAD:"HEAD",CMD:"CMD"},ITEM:{onClick:null,onKeydown:null},HEAD:{onClick:function(a,c,d){a.boxing().toggle(a.getItemIdByDom(d));return false}},CMD:{onClick:function(a,c,d){if(a.onClickButton){a.boxing().onClickButton(a,a.getItemByDom(xui.use(d).parent().get(0)),xui.use(d).id().split("_")[1],d)}return false}},OPT:{onMousedown:function(){return false},onClick:function(a,c,d){a.boxing().onShowOptions(a,a.getItemByDom(d),c,d);return false}}},DataModel:({value:null,borderType:null,cmds:{ini:[]},activeLast:false}),EventHandlers:{onGetContent:function(c,d,a){},onClickButton:function(a,c,d,e){},onShowOptions:function(a,c,d,f){}},RenderTrigger:function(){var c=this,e=c.properties,a=e.items,d;if(e.activeLast&&a.length>0){d=a[a.length-1];c.boxing().fillContent(d.id,d._body)}},_prepareItems:function(d,a,c){if(a.length){a[0]._precheked=d.getClass("ITEM","-prechecked");if(d.properties.activeLast){var e=a[a.length-1];e._show=true;e._fill=true;e._body=d.onGetContent?d.boxing().onGetContent(d,e):d.box._buildBody(d,e)}}return arguments.callee.upper.apply(this,arguments)},_prepareItem:function(g,n){var d=g.properties,f,q="display:none";n._tabindex=d.tabindex;if(!n.caption){n._capDisplay=q}else{n.caption=n.caption.replace(/</g,"&lt;")}n._opt=n.optBtn?"":q;n._body=n._body||"Loading...";if(n._show){n._checked=g.getClass("ITEM","-checked");n._tlgchecked=g.getClass("TOGGLE","-checked")}var c=n.cmds||d.cmds;if(c&&c.length){var e=xui.UI.$tag_subId,k;k=n.cmds=[];for(var j=0,m=c,h=m.length;j<h;j++){if(typeof m[j]=="string"){m[j]={id:m[j]}}if(!m[j].caption){m[j].caption=m[j].id}m[j].id=m[j].id.replace(/[^\w]/g,"_");f=xui.UI.adjustData(g,m[j]);k.push(f);f[e]=n[e]+"_"+f.id}}},_buildBody:function(a,c){return c.text?"<pre>"+c.text.replace(/</g,"&lt;")+"</pre>":""},_onresize:function(){}}});Class("xui.UI.Range",["xui.UI","xui.absValue"],{Instance:{_setCtrlValue:function(a){return this.each(function(f){var d=f.properties,k=d.captionTpl,l=function(p){return f.getSubNode(p)},h=function(p,q){p.cssPos({left:f[q],top:j._x2y(f[q])})},g=function(q,p){q.get(0).style.width=p+"px"},n=l("CAPTION"),o=l("IND1"),m=l("IND2"),e=l("RULER1"),c=l("RULER3"),j=f.box,i=j._v2a(a);f._rate=300/(d.max-d.min);f._v1=Math.round((i[0]-d.min)/(d.max-d.min)*300);f._v2=Math.round((1-(d.max-i[1])/(d.max-d.min))*300);n.html(j._buildTpl(d.singleValue,k,i,d.unit),false);h(o,"_v1");h(m,"_v2");g(e,f._v1+8);g(c,f._v2+8)})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["BOX"])}},Static:{Templates:{style:"{_style}",className:"{_className}",BOX:{tagName:"div",RULER:{tagName:"div",IND1:{tabindex:"{tabindex}",style:"{_single}"},IND2:{tabindex:"{tabindex}"},RULER1:{$order:2,style:"{_single}"},RULER3:{}},TAIL:{tagName:"div",CAPTION:{tagName:"div"},MIN:{text:"{min}"},MAX:{text:"{max}"}}}},Appearances:{"KEY, RULER, IND1, IND1":{"font-size":0,"line-height":0,position:"relative"},BOX:{position:"absolute",left:0,top:0,width:"316px"},"CAPTION, IND1, TAIL, MIN":{"font-size":"12px","line-height":"14px"},RULER:{$order:1,position:"relative",height:"30px",overflow:"visible","margin-bottom":"3px",background:xui.UI.$bg("bg.png"),_background:"none",_filter:xui.UI.$ieBg("bg.png")},"RULER1, RULER3":{position:"absolute",left:0,top:0,height:"30px",width:"300px"},RULER1:{background:xui.UI.$bg("bg.png"),_background:"none",_filter:xui.UI.$ieBg("bg.png")},RULER3:{background:xui.UI.$bg("front.png"),_background:"none",_filter:xui.UI.$ieBg("front.png")},"IND1,IND2":{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,"z-index":"2",width:"15px",height:"14px",position:"absolute"},IND1:{background:xui.UI.$bg("icons.gif","no-repeat left -225px",true),left:"0px",top:"11px"},IND2:{background:xui.UI.$bg("icons.gif","no-repeat -15px -225px",true),left:"300px",top:"1px"},TAIL:{$order:2,width:"300px",position:"relative"},CAPTION:{position:"relative","text-align":"center"},MIN:{position:"absolute",left:0,top:0},MAX:{position:"absolute",right:0,top:0}},Behaviors:{IND1:{onKeydown:function(a,c,d){if(a.properties.disabled||a.properties.readonly){return}a.box._keydown.apply(a.box,[a,c,d,0])},onMousedown:function(c,g,h){if(c.properties.disabled||c.properties.readonly){return}if(xui.Event.getBtn(g)!="left"){return}var f=c.properties,d=c.box,a=d._v2a(f.$UIvalue);xui.use(h).startDrag(g,{widthIncrement:f.steps?f.width/f.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(c._v1),maxRightOffset:Math.floor(c._v2-c._v1),dragCursor:"default"});xui.use(h).css("zIndex",10).focus();c.getSubNode("IND2").css("zIndex",5)},onDrag:function(a,c,g){var f=xui.DragDrop.getProfile();a.box._ondrag.apply(a.box,[a,f.curPos.left,g,0])},onDragstop:function(g,k,a){var c=g.properties,i=g.boxing(),l=g._rate,m=xui.DragDrop.getProfile(),j,h=c.$UIvalue.split(":");g._v1=m.curPos.left;h[0]=Math.floor((g._v1)/l+c.min);i.setUIValue(h.join(":"));if(g._v1==g._v2){xui.use(a).css("zIndex",10);g.getSubNode("IND2").css("zIndex",5)}}},IND2:{onKeydown:function(a,c,d){if(a.properties.disabled||a.properties.readonly){return}a.box._keydown.apply(a.box,[a,c,d,1])},onMousedown:function(c,g,h){if(c.properties.disabled||c.properties.readonly){return}if(xui.Event.getBtn(g)!="left"){return}var f=c.properties,d=c.box,a=d._v2a(f.$UIvalue);xui.use(h).startDrag(g,{widthIncrement:f.steps?f.width/f.steps:null,dragType:"move",targetReposition:true,horizontalOnly:true,maxLeftOffset:Math.floor(c._v2-c._v1),maxRightOffset:Math.floor(300-c._v2),dragCursor:"default"});xui.use(h).css("zIndex",10).focus();c.getSubNode("IND1").css("zIndex",5)},onDrag:function(a,c,g){var f=xui.DragDrop.getProfile();a.box._ondrag.apply(a.box,[a,f.curPos.left,g,1])},onDragstop:function(g,k,a){var c=g.properties,i=g.boxing(),l=g._rate,m=xui.DragDrop.getProfile(),j,h=c.$UIvalue.split(":");g._v2=m.curPos.left;h[1]=Math.floor((g._v2)/l+c.min);i.setUIValue(h.join(":"))}}},DataModel:{position:"absolute",width:{ini:300,readonly:true},height:{ini:46,readonly:true},min:{ini:0,action:function(){var c=this,d,e=c.properties,a=c.boxing();a.refresh();if(e.$UIvalue!=(d=this.box._ensureValue(c,e.$UIvalue))){a.setValue(d)}}},max:{ini:100,action:function(){var c=this,d,e=c.properties,a=c.boxing();a.refresh();if(e.$UIvalue!=(d=this.box._ensureValue(c,e.$UIvalue))){a.setValue(d)}}},unit:{ini:"",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},steps:0,captionTpl:{ini:"{fromvalue}{unit} - {tovalue}{unit}",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},value:"0:100",singleValue:{ini:false,action:function(a){this.boxing().refresh()}}},_prepareData:function(c){var f=arguments.callee.upper.call(this,c);var e=c.properties,a=c.box._v2a(e.value);f._single=e.singleValue?"display:none":"";e.min=parseFloat(e.min);e.max=parseFloat(e.max);f.min=f.min+e.unit;f.max=f.max+e.unit;return f},_ensureValue:function(d,k){if(!k){k=""}var c=d.properties,j=k.split(":"),f=c.min,h=c.max,i=[],g=function(l){return parseFloat(l)},e=function(l){return Math.min(h,Math.max(f,l))};i[0]=g(j[0]);i[1]=g(j[1]);i[0]=Math.min(i[0],i[1]);if(!f){f=i[0]}if(!h){h=i[1]}i[0]=e(i[0]);i[1]=e(i[1]);return i.join(":")},_v2a:function(a){return typeof a=="string"?a.split(":"):a},_buildTpl:function(e,c,a,d){return e?a[1]+d:c.replace(/\{fromvalue\}/g,a[0]).replace(/\{tovalue\}/g,a[1]).replace(/\{unit\}/g,d)},_x2y:function(a){return Math.floor(15+1-(a)*(15/300))},_keydown:function(d,j,a,k){var p=xui.Event.getKey(j);if(p.key=="left"||p.key=="right"){var q=xui.use(a).get(0).style,c=parseInt(q.left,10),o=d.properties,l=o.steps,m=300/l,n,h=function(e){return parseInt(d.getSubNode(e).get(0).style.left,10)};c+=p.key=="left"?-1:1;if(l){c=c-c%m;if(p.key=="right"){c+=m}}if(!o.singleValue){if(k===0){n=h("IND2");if(c>n){c=n}}else{n=h("IND1");if(c<n){c=n}}}if(c<0){c=0}if(c>300){c=300}q.left=c+"px";d.box._ondrag.apply(d.box,[d,c,a,k]);var i=d._rate,g=o.$UIvalue.split(":");if(k===0){d._v1=c;g[0]=Math.floor((d._v1)/i+o.min)}else{d._v2=c;g[1]=Math.floor((d._v2)/i+o.min)}d.boxing().setUIValue(g.join(":"))}},_ondrag:function(i,h,a,s){var e=i.properties,n=xui.DragDrop.getProfile(),l=i.box,o=function(d){return i.getSubNode(d)},j=function(f,d){f.get(0).style.width=d+"px"},q=o("CAPTION"),g=o("RULER1"),c=o("RULER3"),r,m,k=this._v2a(e.$UIvalue);xui.use(a).get(0).style.top=this._x2y(h)+"px";r=Math.floor((h)/i._rate+e.min);if(s){k[1]=r;j(c,h+8)}else{k[0]=r;j(g,h+8)}q.html(l._buildTpl(e.singleValue,e.captionTpl,k,e.unit),false)},_onresize:function(){}}});Class("xui.UI.Calendar","xui.UI.DatePicker",{Instance:{setDayInfo:function(c,a,e){var d=this.getSubNode(c,""+a);if(d.get(0)){d.get(0).innerHTML=e}return this},addContents:function(a,c){this.getSubNode("DC",""+a).append(c);return this},clearContents:function(a){this.getSubNode("DC",""+a).empty();return this}},Initialize:function(){var o=this,p=xui.UI.$ID,B=xui.UI.$tag_special,c=xui.UI.$CLS,C=o.KEY;o.addTemplateKeys(["H","W","COL","DH","DAYBOX","DC","TBODY","THEADER","TD","DF1","DF2","DF3","DF4"]);var m='<colgroup id="'+C+"-COL:"+p+':"  class="'+B+"COL_CS"+B+'"  style="'+B+"COL_CS"+B+'"><col width="2%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/></colgroup>',e='<thead ID="'+C+"-THEADER:"+p+':" class="'+B+"THEADER_CS"+B+'"  style="'+B+"THEADER_CS"+B+'" ><tr height="1%"><th id="'+C+"-H:"+p+':7" class="xui-node xui-node-th '+c+"-h "+B+"H_CC"+B+'"  style="'+B+"H_CS"+B+'"></th>',d="</tr></thead>",h='<th id="'+C+"-H:"+p+':@" class="xui-node xui-node-th '+c+"-h "+B+"H_CC"+B+'"  style="'+B+"H_CS"+B+'">@</th>',t='<tbody id="'+C+"-TBODY:"+p+':"  class="'+B+"TBODY_CS"+B+'"  style="'+B+"TBODY_CS"+B+'">',r="</tbody>",A="<tr>",y="</tr>",g='<th id="'+C+"-W:"+p+':@"  class="xui-node xui-node-th '+c+"-w "+B+"W_CC"+B+'" style="'+B+"W_CS"+B+'">@</th>',f='<td id="'+C+"-TD:"+p+':@" class="xui-node xui-node-td '+c+"-td "+B+"TD_CC"+B+'"  style="'+B+"TD_CS"+B+'" '+xui.$IEUNSELECTABLE()+'  ><div id="'+C+"-DAYBOX:"+p+':@" class="xui-node xui-node-div '+c+"-daybox "+B+"DAY_CC"+B+'"  style="'+B+"DAY_CS"+B+'" '+xui.$IEUNSELECTABLE()+' ><div id="'+C+"-DH:"+p+':@" class="xui-node xui-node-div '+c+"-dh "+B+"DH_CC"+B+'"  style="'+B+"DH_CS"+B+'"></div><div id="'+C+"-DF1:"+p+':@" class="xui-node xui-node-div '+c+"-df1 "+B+"DF1_CC"+B+'" style="'+B+"DF1_CS"+B+'"></div><div id="'+C+"-DF2:"+p+':@" class="xui-node xui-node-div '+c+"-df2 "+B+"DF2_CC"+B+'" style="'+B+"DF2_CS"+B+'"></div><div id="'+C+"-DF3:"+p+':@" class="xui-node xui-node-div '+c+"-df3 "+B+"DF3_CC"+B+'" style="'+B+"DF3_CS"+B+'"></div><div id="'+C+"-DF4:"+p+':@" class="xui-node xui-node-div '+c+"-df4 "+B+"DF4_CC"+B+'"  style="'+B+"DF4_CS"+B+'"></div><div id="'+C+"-DC:"+p+':@" class="xui-node xui-node-div '+c+"-dc "+B+"DC_CC"+B+'"  style="'+B+"DC_CS"+B+'"></div></div></td>',n,v,u,s,q,z=[],w=[];for(v=0;v<7;v++){w[w.length]=h.replace(/@/g,v)}s=q=0;for(v=0;v<48;v++){u=v%8;z[z.length]=(u==0?A:"")+(u==0?g:f).replace(/@/g,u==0?q:s)+(u==7?y:"");if(u!==0){s++}else{q++}}n=m+e+w.join("")+d+t+z.join("")+r;o.setTemplate({tagName:"div",style:"{_style}",className:"{_className}",onselectstart:"return false",BORDER:{tagName:"div",BODY:{$order:1,tagName:"table",cellpadding:"0",cellspacing:"0",width:"100%",text:n}}});delete o.$Keys.YEAR;delete o.$Keys.MONTH},Static:{Behaviors:{DroppableKeys:["DAYBOX"],HoverEffected:{},ClickEffected:{},onSize:xui.UI.$onSize,TD:{onClick:null,onDblclick:function(c,f,g){var d=c.properties,a=c.getSubId(g);if(d.disabled){return false}c.boxing().onDblclick(c,a,f,g)}}},DataModel:{handleHeight:null,tipsHeight:null,closeBtn:null,timeInput:null,dataBinder:null,dateField:null,dock:"fill",width:200,height:200},EventHandlers:{onDblclick:function(a,c,d,f){},beforeClose:null},_getLabelNodes:function(a){return a.$day1||(a.$day1=a.getSubNode("DF1",true))},_getDayNodes:function(a){return a.$day2||(a.$day2=a.getSubNode("DAYBOX",true))},Appearances:{"DAYBOX, DC":{position:"relative"},"DF1, DF2, DF3, DF4":{position:"absolute","white-space":"nowrap"},DF1:{left:"2px",top:"2px"},DF2:{right:"2px",top:"2px"},DF3:{left:"2px",bottom:"2px"},DF4:{right:"2px",bottom:"2px"},DAYBOX:{overflow:"hidden"},DC:{"text-align":"left"},TD:{"background-color":"#F9F7D1"},"TD-checked":{$order:1},"TD-free":{$order:1,"background-color":"#FFF"}},_onresize:function(e,d,a){var h=e.properties,g=function(f){return e.getSubNode(f)},c;if(a){g("BORDER").height(c=a);g("BODY").height(c);c=(c-16)/6-1;e.box._getDayNodes(e).height(c)}}}});